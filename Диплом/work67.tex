 \documentclass [12pt]{article}
\usepackage{amssymb,amsmath, amsthm, amscd,ifthen}
\usepackage[warn]{mathtext}          % русские буквы в формулах, с предупреждением
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[english,russian]{babel}
\usepackage[russian]{babel}
\usepackage[dvips]{graphicx}
\usepackage[hyper]{amsbib}
\usepackage{indentfirst}

%\usepackage{setspace}
%\doublespace

\usepackage{amssymb}
\usepackage[ruled,noline,titlenumbered,linesnumbered,noend,norelsize]{algorithm2e}
\DontPrintSemicolon
\SetNlSty{footnotesize}{}{}
\IncMargin{0.5em}
\SetNlSkip{1em}
\SetKwIF{If}{ElseIf}{Else}{if}{then}{else if}{else}{endif}
\SetKw{Return}{return}
\SetKw{Pick}{pick}
\SetNlSkip{2em}
\newenvironment{algorithm-hbox}{\hbadness=10000\begin{algorithm}}{\end{algorithm}}

\newtheorem{theorem}{Теорема}
\newtheorem{claim}{Утверждение}
\newtheorem{lemma}{Лемма}
\newtheorem{corollary}{Следствие}
\newtheorem{note}{Замечание}
\newtheorem{definition}{Определение}
\newtheorem{proposition}{Утверждение}
\newenvironment{proof1}{\noindent{\it Proof.\,}}{\hfill$\Box$}

\textheight232truemm
\textwidth170truemm
\hoffset=-15mm
\voffset=-25mm

\textheight232truemm
\textwidth170truemm
\hoffset=-15mm
\voffset=-25mm


\begin{document}

\begin{titlepage} 
	\begin{center} 
	{ ФЕДЕРАЛЬНОЕ ГОСУДАРСТВЕННОЕ БЮДЖЕТНОЕ ОБРАЗОВАТЕЛЬНОЕ УЧРЕЖДЕНИЕ ВЫСШЕГО ОБРАЗОВАНИЯ\\ «МОСКОВСКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ \\имени 
			М.В.ЛОМОНОСОВА»} 
	\end{center} 
	
	
	\begin{center} 
		{ МЕХАНИКО-МАТЕМАТИЧЕСКИЙ ФАКУЛЬТЕТ} 
	\end{center} 
	
	
	\begin{center} 
		{ КАФЕДРА ТЕОРИИ ВЕРОЯТНОСТЕЙ} 
	\end{center} 
	\ 
	
	\ 
	
	
	\begin{center} 
		{ВЫПУСКНАЯ КВАЛИФИКАЦИОННАЯ РАБОТА\\(ДИПЛОМНАЯ РАБОТА) \\специалиста} 
	\end{center} 
	\ 
	
	\begin{center}{\large\bf ЭКСТРЕМАЛЬНЫЕ ЗАДАЧИ ДЛЯ НЕКОТОРЫХ КЛАССОВ ГИПЕРГРАФОВ} 
	\end{center} 
	
	\ 
	
	\ 
	
	\ 
	
	\begin{flushright} 
		Выполнила студентка\\ 
		608 группы\\ 
		Ахмеджанова Маргарита \\ 
		\vspace{6ex} 
		$\underset{\text{(подпись студента)}}{\underline{\hspace{0.35\textwidth}}}$\\ 
		\vspace{2ex} 
		Научный руководитель:\\ 
		д.ф.-м.н. Шабанов Д.А.\\ 
		\vspace{6ex} 
		$\underset{\text{(подпись научного руководителя)}}{\underline{\hspace{0.35\textwidth}}}$\\ 
		
	\end{flushright} 
	\vspace{26ex} 
	\begin{center} 
		{ Москва\\ 2018} 
	\end{center} 
	
	
\end{titlepage}

\begin{center}
	\LARGE\bf{Аннотация}
\end{center}

Настоящая работа посвящена исследованию нескольких классических задач о
раскрасках гиперграфов, находящихся на стыке теории графов и экстремальной теории вероятностей.
Все результаты дипломной работы являются новыми и улучшают ранее известные теоремы из данных областей.

Дадим основные определения из теории гиперграфов. Гиперграф является некоторым обобщением графа, в котором ребром могут соединяться не только две вершины, но и любые подмножества вершин. В $n$-однородном гиперграфе, каждое ребро содержит ровно $n$ вершин. Степенью ребра гиперграфа называется число других ребер данного гиперграфа, имеющих с данным хотя бы одну общую вершину. 

Раскраска множества вершин $V$ гиперграфа $H = (V, E)$ называется правильной, если
в этой раскраске все ребра из $E$ не являются одноцветными.  Если для гиперграфа $H$ существует правильная раскраска в $r$ цветов, то говорят, что $H$ является $r$-раскрашиваемым. Наконец, хроматическим числом гиперграфа $H$, $\chi(H)$, называется такое минимальное $r$, что $H$ является $r$-раскрашиваемым.

\bigskip
Гиперграф $H=(V,E)$ называется $b$-простым, если каждые два его различных ребра имеют не более $b$ общих вершин. \textbf{  Теоремы \ref{mntheorem3}} позволяет установить количественную связь хроматического числа $b$-простого гиперграфа и его максимальной степени ребра.

\bigskip
Правильные раскраски  допускают различные обобщения, одним из которых являются справедливые раскраски. Раскраска множества вершин гиперграфа называется \emph{справедливой} (в мировой литературе используется термин \emph{equitable}), если она является правильной и при этом мощности всех цветовых классов отличаются не более, чем на единицу.

\textbf{Теорема \ref{mntheorem}} и \textbf{Теорема \ref{mntheorem2}}, отличающиеся техникой доказательства, касаются справедливых раскрасок. А именно, для  $r=2$ и для $r>2$ получены оценки на число ребер  $n$-однородного гиперграфа, которые обеспечивают существование  справедливой раскраски в $r$ цветов. Замечательным является тот факт, что нам удалось добиться того, чтобы наша оценка для справедливых раскрасок совпала с наилучшей оценкой  для правильных раскрасок.



\setcounter{page}{2}            % Нумерация страниц начинается с "2"

\newpage                        % Начинает текст с новой страницы
\tableofcontents                % Автоматическое создание оглавления по названиям разделов, подразделов и т.п.

\newpage
\section{Введение}

\subsection{ Основные определения }
	Настоящая работа посвящена исследованию нескольких классических задач о раскрасках гиперграфов, находящихся на стыке теории графов и экстремальной теории вероятностей. Для удобства текст работы разбит на три главы. В первой главе мы изучаем справедливые раскраски в $r$ цветов. Вторая глава посвящена справедливым раскраскам в два цвета. В третьей главе идет речь о $b$-простых гиперграфах и количественной связи хроматического числа $b$-простого гиперграфа и его максимальной степени ребра.
	
	\bigskip
    Напомним, что гиперграфом называется пара $H = (V, E)$, где $V = V (H)$ --- некоторое множество, называемое множеством вершин гиперграфа, а $E = E(H)$ --- произвольная совокупность подмножеств множества $V$, называемых ребрами гиперграфа. Гиперграф является $n$-однородным, если каждое его ребро содержит ровно $n$ вершин. Отметим, что в частном случае $n=2$ мы в точности получаем классическое определение графа. Степенью ребра гиперграфа называется число других ребер данного гиперграфа, имеющих с данным хотя бы одну общую вершину. Максимальная степень ребра гиперграфа $H$ обозначается через $\Delta(H)$.
	
	\bigskip
	Раскраска множества вершин $V$ гиперграфа $H = (V, E)$ называется правильной, если
	в этой раскраске все ребра из $E$ не являются одноцветными. Если для гиперграфа $H$ существует правильная раскраска в $r$ цветов, то говорят, что $H$ является $r$-раскрашиваемым. Наконец, хроматическим числом гиперграфа $H$, $\chi(H)$, называется такое минимальное $r$, что $H$ является $r$-раскрашиваемым.
	
	\bigskip
	Гиперграф $H=(V,E)$ называется $b$-простым, если каждые два его различных ребра имеют не более $b$ общих вершин. Гиперграфы, являющиеся 1-простыми, принято также называть простыми или линейными. В общем случае $b$-простые гиперграфы хорошо известны в мировой литературе как частичные системы Штейнера, полные же системы Штейнера являются одним из основных объектов изучения в теории кодирования. Отметим важнейшее свойство $b$-простого гиперграфа --- любой его набор из $b+1$ вершины полностью содержится не более чем в одном ребре (или ровно в одном в случае полной системы Штейнера).
	
	\bigskip
	Напомним, что раскраска множества вершин гиперграфа называется \emph{справедливой}, если она является правильной и при этом мощности всех цветовых классов отличаются не более чем на единицу (тем самым, все цвета задействуются почти одинаковое число раз). Последнее означает, что множество вершин $V$ можно разбить не просто на $r$ независимых множеств, а на $r$ независимых множеств почти одинакового размера.
	
	\subsection{История задачи о хроматического числе $b$-простого гиперграфа и новый результат}
	
	Данная задача посвящена поиску количественной связи хроматического числа $b$-простого гиперграфа и его максимальной степени ребра. Впервые подобная связь была установлена в классической работе П. Эрдеша и Л. Ловаса \cite{ErdLov}, которые показали, что если максимальная степень ребра $n$-однородного гиперграфа $H$ не превосходит
	\begin{equation}\label{delta_erdlov}
	\Delta(H)\leqslant \frac{1}{4}r^{n-1},
	\end{equation}
	то $\chi(H)\leqslant r$. Однако, как оказалось в дальнейшем, неравенство \eqref{delta_erdlov} не является оптимальным и оценка максимальной степени ребра, обеспечивающую $r$-раскрашиваемость гиперграфа, была неоднократно усилена различными исследователями. Авторы рекомендуют читателю обзорную работу \cite{RaigShab} для знакомства с историей задачи. Мы же отметим только последние работы в данной области. В случае, когда число цветов $r$ не велико по сравнению с параметром однородности $n$, наилучший результат был получен Д. Черкашиным и Я. Козиком \cite{CherkKozik}:
	если максимальная степень ребра $n$-однородного гиперграфа $H$ не превосходит
	\begin{equation}\label{delta_cherkkozik}
	\Delta(H)\leqslant c\left(\frac{n}{\ln n}\right)^{\frac{r-1}{r}}r^{n-2},
	\end{equation}
	где $c>0$ --- некоторая абсолютная константа, то $\chi(H)\leqslant r$. Отметим, что в частном случае $r=2$ данный результат был ранее доказан Дж Радхакришнаном и А. Сринивасаном в \cite{RadhSrin}. Однако, как легко видеть, при $r>n$, оценка \eqref{delta_cherkkozik} становится хуже классической оценки \eqref{delta_erdlov}. Данное недоразумение было исправлено в работе И.А. Акользина и Д.А. Шабанова \cite{AkolShab}, которые показали, что если $r>n$ и максимальная степень ребра $n$-однородного гиперграфа $H$ не превосходит
	\begin{equation}\label{delta_akolshab}
	\Delta(H)\leqslant c\,\frac{n}{\ln n}r^{n-1},
	\end{equation}
	где $c>0$ --- некоторая абсолютная константа, то $H$ является $r$-раскрашиваемым.
	
	\bigskip
	В своей работе \cite{ErdLov} Эрдеш и Ловас доказали существование $n$-однородных простых гиперграфов со сколь угодно большим хроматическим числом и поставили вопрос о нахождении количественной связи хроматического числа простого гиперграфа и его максимальной степени ребра. Первый нетривиальный результат здесь был получен в работе З. Сабо \cite{Szabo}, который показал, что для любого $\varepsilon>0$ и любого $n$-однородного простого гиперграфа $H$ неравенство $\Delta(H)\leqslant n^{1-\varepsilon}2^n$ означает $2$-раскрашиваемость $H$, если $n>n_0(\varepsilon)$. Данное утверждение было обобщено А.В. Косточкой и М. Кумбхатом в \cite{KK}: для заданных $b\geqslant 1$, $r\geqslant 2$ и $\varepsilon>0$ и достаточно большого $n>n_0(r,b,\varepsilon)$ любой $n$-однородный $b$-простой гиперграф $H$ с условием
	\begin{equation}\label{delta_kk}
	\Delta(H)\leqslant n^{1-\varepsilon}r^{n-1}
	\end{equation}
	является $r$-раскрашиваемым. Отметим сразу два момента.
	\begin{itemize}
		\item В случае $r=2$ оценка \eqref{delta_kk} заметно сильнее \eqref{delta_cherkkozik}, которая в данной ситуации принимает вид $(n/\ln n)^{1/2}2^n$, в то время как \eqref{delta_kk} дает $n^{1-o(1)}2^n$.
		\item Величина $\varepsilon>0$ в \eqref{delta_kk} может быть выбрана сколь угодно малой при достаточно большом $n$, тем самым, ее можно заменить на некоторую функцию $\varepsilon(n)$, стремящуюся к нулю с ростом $n$.
	\end{itemize}
	
	Последнее наблюдение породило целую серию работ \cite{Kozik}, \cite{KupShab},  \cite{Shab2} в которых авторы последовательно улучшали оценки на функцию $\varepsilon(n)$. Наконец, Я. Козику и Д.А. Шабанову \cite{KozikShab} удалось показать, что для случая простых гиперграфов можно положить $\varepsilon(n)=0$, а именно они установили, что если $H$ --- простой $n$-однородный гиперграф с условием
	\begin{equation}\label{delta_kozikshab}
	\Delta(H)\leqslant c\cdot n\,r^{n-1},
	\end{equation}
	где $c>0$ --- некоторая абсолютная константа, то $H$ является $r$-раскрашиваемым.
	
	\bigskip
	Целью настоящей работы является обобщение соотношения \eqref{delta_kozikshab} для класса $b$-простых гиперграфов. Основной результат сформулирован в следующей теореме.
	
	\begin{theorem}\label{mntheorem3}
		Для достаточно большого $n\geqslant n_0(b)$ всякий $b$-простой $n$-однородный гиперграф $H$, удовлетворяющий условию \label{bound:new}
		\begin{equation}\label{delta_new}
		\Delta(H)\leqslant(2e)^{-4}nr^{n-b}
		\end{equation}
		является $r$-раскрашиваемым.
	\end{theorem}
	Сравним полученный результат с ранее известными. Ясно, что при $b=1$ оценка \eqref{delta_new} полностью совпадает с \eqref{delta_kozikshab}. При $b>1$ наилучшим оставался результат Козика из работы \cite{Kozik}, где была обоснована оценка
	$$
	\Delta(H)=O\left(\frac{n}{\ln n}r^{n-b-1}\right),
	$$
	обеспечивающая $r$-раскрашиваемость гиперграфа. Легко видеть, что наша новая оценка заметно лучше. Отметим, однако, что при $b>1$ оценка \eqref{delta_new} будет слабее результата \eqref{delta_akolshab}, выполненного для всего класса однородных гиперграфов, а не только $b$-простых, уже при $r>\ln n$.
	
	\bigskip
	Насколько результат теоремы \ref{mntheorem3} далек от максимально возможного? Как показали А.В. Косточка и В. Рёдль в \cite{KostRodl} для любых $n,r\geqslant 2$ существует простой $n$-однородный гиперграф с хроматическим числом больше $r$ и максимальной степенью ребра не более $n^2r^{n-1}\ln r$. Тем самым, при фиксированных $r$ и $b$ наша оценка не более чем в $n$ раз слабее максимально возможного результата.
	
	\subsection{История задачи о справедливых раскрасках в два цвета и новый результат}
	
	Во второй главе исследуется известная задача экстремальной комбинаторики, связанная с раскрасками гиперграфов в два цвета. 
	
    Гиперграф обладает \emph{свойством $B$} (в англоязычной литературе используется термин Property B), если найдется раскраска множества его вершин в два цвета, при которой все его ребра неодноцветны. Такие раскраски называют \emph{правильными}. 
	
	В 1961 году Эрдеш и Хайнал \cite{ErdHaj} поставили задачу об отыскании величины  $m(n)$,  равной наименьшему количеству ребер в  $n$-однородном гиперграфе, который не обладает свойством $B$. Формально,
\begin{gather*}
m(n) = min\{|E| : H = (V, E) - \text{$n$--однородный гиперграф $H$,}\\ H  \text{~~не обладает свойством $B$}\}.
\end{gather*}
На сегодняшний день известно, что
\begin{equation}\label{m(n)}
0.1\left(\frac{n}{\ln n}\right)^{1/2}2^{n}\leqslant m(n)\leqslant \frac{e\ln 2}{4}n^22^{n}(1+o(1))
\end{equation}
 Нижняя оценка в (1.\href(1) принадлежит Радхакришнану и Сринивасану \cite{RadhSrin}, а верхняя --- Эрдешу \cite{Erd}. Автор рекомендует читателю обзорную работу \cite{RaigShab} для знакомства с историей задачи.
	
\bigskip
 Нами доказано, что  что нижняя оценка из (\ref{m(n)}) обеспечивает возможность не только правильной, но справедливой раскраски в два цвета.
	
	\begin{theorem}\label{mntheorem}
		Пусть $n>5$, а $H=(V,E)$ произвольный $n$--однородный гиперграф c условием
		\begin{equation}
		|E|\leq 0.01\sqrt{\frac{n}{\ln n}}2^{n}.
		\end{equation}
		Тогда для $H$ существует справедливая раскраска в два цвета.
	\end{theorem}
	
	Наличие справедливой раскраски можно исследовать не только при ограничении на число ребер, но и при условии, когда ограничены степени вершин гиперграфа. Так, в 1970 году Хайнал и Семереди \cite{HajSem} доказали знаменитую гипотезу  Эрдеша \cite{Erd2}:\emph{ любой граф $G$ с максимальной степенью вершины $\Delta(G)$ допускает не только правильную, но и справедливую раскраску в $\Delta(G)+1$ цветов.}
	Позже, доказательство этого фундаментального факта было значительно упрощено X. Киерстедом и А.В. Косточкой \cite{KierKost}, они же совместно с М. Мидларжем и Е. Семереди отыскали \cite{KKMS} быстрый Алгоритм для получения искомой справедливой раскраски.
	
	В случае $n$-однородных гиперграфов $\mathcal{H}$ Шабанов \cite{Shab3} показал, что для всякого простого  гиперграфа( любые два его ребра имеют не более одной общей вершины) $H\in\mathcal{H}$, а также для всякого гиперграфа $H\in\mathcal{H}$ с большим количеством вершин условие на максимальную степень вершины $\Delta(H):$

\begin{equation*}
\Delta(H)\leq c\cdot 2^{n-1}/\sqrt{n\ln n}
\end{equation*}

обеспечивает возможность справедливой раскраски $H$ в два цвета.
Позже, этот результат был улучшен И. Акользиным \cite{Akol}, который доказал, что для больших $n$ верна оценка:

\begin{equation*}
\Delta(H)\leq c\cdot 2^{n-1}
\end{equation*}
	
    \subsection{Справедливые раскраски в $r$ цветов и новый результат}
	
	А.Косточка \cite{Kost} доказал следующую теорему: если $r<\sqrt{\frac{1}{8}\ln\frac{ln}{2}}$  и число ребер \\
	$n$-однородного гиперграфа $H$ не превосходит
	
	\begin{equation*}
	|E|\leq e^{-4r^2}\left(\frac{n}{\ln(n)}\right)^{\lfloor log_{2}(r)/\log_{2}(r)+1\rfloor} r^{n},
	\end{equation*}
	
	то $H$ является $r$-раскрашиваемым.
	
	Легко показать, что тривиальная оценка $|E|<r^{n-1}$ обеспечивает возможность справедливой раскраски $H$ в $r$ цветов.
	Однако, в отличии от правильных раскрасок, другие оценки на число ребер автом неизвестны.
	
	Наш результат сформулирован в следующей теореме:
	
	\begin{theorem}\label{mntheorem2}
		Пусть $H=(V,E)$ произвольный $n$-однородный гиперграф c условием
		
		\begin{equation*}
		|E|\leq 0.05\left(\frac{n}{\ln n}\right)^{\lfloor \log_{2}(r)/\log_{2}(r)+1\rfloor} r^{n-1},
		\end{equation*}
		где число цветов $r\leq\sqrt{\frac{\ln n}{-64(\ln c)(\ln \ln n)^3}}$. Тогда для $H$ существует не только правильная, но справедливая раскраска в $r$ цветов.
	\end{theorem}
	
	Таким образом, любой $n$-однородный гиперграф с ограниченным  числом ребер допускает не только правильную раскраску в $r$ цветов, но и справедливую. Эта теорема существенно усиливает ранее известный результат.
	
	\newpage		
	\section{ Доказательство Теоремы  \ref{mntheorem3}}
		
	Для доказательства Теоремы \ref{mntheorem3} нам необходимо показать, что любой $b$-простой гиперграф с ограниченными степенями ребер является $r$-раскрашиваемыми. Основу доказательства составляет метод случайной перекраски, впервые предложенный Й. Беком \cite{Beck}. Мы же используем его модификацию, примененную Козиком и Шабановым в \cite{KozikShab}. Опишем данный подход более детально. 
		
			
   \subsection{Метод случайной перекраски}
   
   Пусть $H=(V,E)$ --- $b$-простой $n$-однородный гиперграф. Наша цель --- построить некоторую случайную раскраску множества его вершин в $r$ цветов и показать, что она является правильной с положительной вероятностью. Для построения подобной раскраски зададим случайный порядок на множестве вершин гиперграфа $V$ c помощью отображения $\sigma:V \to [0,1]$, где $\sigma(v),v\in V$ --- независимые случайные величины с равномерным распределением на $[0,1]$. Значение $\sigma(v)$ будем называть весом вершины $v$. С вероятностью единица отображение $\sigma$ инъективно на $V$. Если $\sigma(v)<p$, где $p$ --- некоторый параметр нашей конструкции, то вершину $v$ будем называть $\emph{свободной}$.
   
   \bigskip
   Рассмотрим также случайную раскраску вершин $f:V \to \{0, \ldots, r-1\}$, имеющую равномерное распределение на множестве всех раскрасок. Предположим, что нам не повезло и в случайной раскраске $f$ появились одноцветные ребра. Для исправления ситуации мы используем следующий Алгоритм  перекраски:
   \begin{enumerate}
   	\item если в текущий раскраске имеется одноцветное ребро $A$ цвета $\alpha\in\{0,\ldots,r-1\}$, содержащее еще не перекрашивавшиеся $\emph{свободные}$ вершины, то выберем ту вершину $v$ из них, которая имеет наименьший вес;
   	\item перекрасим вершину $v$ в цвет $(\alpha+1)({\rm mod}\; r)$;
   	\item будем говорить, что вершина $v$ \emph{обвиняет} ребро $A$;
   	\item повторяем первый шаг, пока возможно.
   \end{enumerate}
   Формально, этот Алгоритм может быть описан следующим способом:
   
   \bigskip
   \begin{algorithm-hbox}[H]
   	\caption{Алгоритм перекраски}
   	\textbf{Input:} $f:V \to \{0, \ldots, r-1 \},\; \sigma:V \to [0,1]$ инъекция\\
   	\While{есть одноцветное ребро, в котором первая неперекрашенная вершина $v$ свободна.}{
   		$f(v)_{mod(r)} \gets (f(v)+1)_{mod(r)}$\hspace{1cm} 
   	} 	
   	\Return $f$
   \end{algorithm-hbox}	
   %
   
   \bigskip
   Отметим, что в рамках процедуры перекраски каждая вершина меняет цвет не более одного раза, поэтому Алгоритм не может работать бесконечно и обязательно остановится.
			
   \bigskip
   Следующим этапов доказательства является анализ конфигураций, которые получаются, когда Алгоритм не построил правильную раскраску. Козик и Шабанов показали, что такие конфигурации имеют определенный тип. Однако, для получения заявленных результатов нам придется использовать некоторые новые идеи и конструкции, которых не было в \cite{KozikShab}.
	
\subsection{Конструкция $h$-дерева}

Пусть даже Алгоритм не помог и по итогам его работы гиперграф $H$ все еще содержит одноцветные ребра. Обозначим через $A$ одно из подобных одноцветных ребер. Пусть его цвет в финальной раскраске равен $\alpha$. Заметим, что ребро $A$ может содержать вершины только двух типов: каждая $v\in A$
\begin{itemize}
	\item либо несвободная вершина с изначальным цветом $f(v)=\alpha$;
	\item либо свободная вершина с изначальным цветом $f(v)=\alpha-1$.
\end{itemize}
Однако во втором случае вершина $v$ обязана обвинять некоторое другое ребро $B$, иначе она не смогла бы сменить свой цвет в процессе перекраски.

\bigskip
Начнем построение конфигурации ребер $H$, которую мы назовем $h$-деревом. 
\begin{itemize}
\item В качестве корня мы возьмем ребро $A$, а его потомками будут все ребра $B$, которые обвиняются вершинами $A$ (по одному ребру для каждой вершины).
\item  Далее, в каждом ребре $B$ также могли быть вершины, имевшие изначальный цвет не $\alpha-1$, а $\alpha-2$. Подобные вершины также обязаны обвинять некоторые новые ребра $C$, иначе ребро $B$ не могло бы стать одноцветным и, в свою очередь, никто не смог бы его обвинить. Добавим подобные ребра $C$ в качестве потомков ребра $B$.
\item Продолжим процесс построения, пока будет возможно. 
\end{itemize}

\bigskip
В результате построения мы получим конфигурацию $T$, вершинами которой выступают ребра гиперграфа $H$, а связь определяется отношениями обвинения. Для того, чтобы не путать вершины гиперграфа $H$ c вершинами  индуцированного графа $T$, будем называть последние \emph{узлами}. Отметим, что необходимым условием включения произвольного ребра в данную конструкцию является условие его одноцветности на некотором шаге Алгоритма перекраски. 

\begin{corollary}
Если Алгоритм перекраски не построил правильную раскраску $H$ в $r$-цветов, то образовалась хотя бы одна $T$ конфигурация.
\end{corollary}
Доказательство данного факта можно найти в Утверждении 4 из работы \cite{KozikShab}.

\bigskip
Докажем, что при определенных ограничениях конфигурация $T$ является деревом.
\begin{lemma}
	Если в изначальной раскраске гиперграфа $H$ не было одноцветных ребер, в которых все вершины были бы свободными, то либо получается древовидная конфигурация $T$, либо мы получаем  правильную раскраску $H$ в $r$ цветов.
\end{lemma}
\begin{proof}
	Действительно, наличие цикла означало бы существование такого узла $A$, что ребро $e(A)$ обвинила сначала одна вершина, а потом либо его обвинила другая вершина, либо узел $A$ стал корнем. Рассмотрим ситуации подробней. Поскольку обвинять можно только те ребра, которые были одноцветными на некотором шаге Алгоритма перекраски, будем считать, что ребро $e(A)$  было цвета $\alpha_{mod(r)}$. Тогда в результате обвинения ребро $e(A)$ перестало быть одноцветным и стало содержать вершины двух цветов: $\alpha_{mod(r)}$ и $(\alpha+1)_{mod(r)}$. Теперь, чтобы цикл замкнулся на узле $A$ нужно чтобы ребро $e(A)$ снова стало одноцветным, последнее возможно, если в ребре $e(A)$ в изначальной раскраске все вершины были свободные цвета $\alpha_{mod(r)}$. Поэтому если мы запретим существование таких ребер, то у нас не будет циклов в конфигурации $T$.
\end{proof}

\bigskip
Назовем  древесную конфигурацию $T$ $h$-деревом. Листьями получившегося дерева будут как раз те ребра, которые были одноцветными в исходной случайной раскраске $f$. 
Формальное определение $h$-дерева выглядит следующим образом:

\bigskip
\emph{$h$-дерево} --- это корневое дерево, пронумерованное по следующему правилу:
	
\begin{enumerate}
		\item любому узлу $x$ $h$-дерева соответствует ребро гиперграфа $e(x)$. 
		\item каждому ребру $f$ $h$-дерева соответствует $v(f)$ вершина гиперграфа.
		\item для любого ребра $f=(x_{1},x_{2})$ выполнено что $v(f)\in (e(x_{1})\cap e(x_{2})).$
\end{enumerate}

\subsection{ Локальная Лемма}

В \cite{Shab2} З.Сабо использововал специальный вариант Локальной Леммы, представляющий обобщение основного варианта, предложенного Й. Беком \cite{Beck}. Мы же используем следующее обобщение из  \cite{Kozik}.

\begin{lemma}(Локальная лемма)\label{LocalLemma}
	
	Пусть $\chi=\{X_{1},X_{2}\ldots,X_{m}\}$ --- независимые случайные величины (или векторы) на произвольном вероятностном пространстве, а $\mathcal A=\{A_{1},...,A_{k}\}$--- множество событий, принадлежащих  алгебре, порожденной этими случайными  величинами. Для каждого $A_{j}$ обозначим через $vbl(A_{j})$ минимальное подмножество случайных величин $\chi$ таких, что $A_{j}$ полностью принадлежит порожденной ими алгебре. Далее, для каждого $X\in\chi$ мы определяем многочлен $w_{X}(z)$:
	
	\begin{equation}\label{local:polynomial}
	w_{X}(z)=\sum_{A\in\mathcal A:X\in vbl(A)}Pr(A)z^{|vbl(A)|}
	\end{equation}
	
	Предположим, что существует многочлен $w(z)$, мажорирующий все многочлены $w_{X}(z)$, т.е. для любого действительно числа $z_{0}\ge 1$ выполняется $w(z_{0})\ge w_{x}(z_{0})$. Если существует $\tau_{0}\in (0,1):$
	
	\begin{equation}\label{local:condition}
	w(\frac{1}{1-\tau_{0}})\le \tau_{0}
	\end{equation}
	
	Тогда, с положительной вероятностью можно избежать все события из $\bar{A}$, т.е.
	 
	\begin{equation}Pr(\cap_{A\in\mathcal A}\bar{A})>0.
	\end{equation}
	
\end{lemma}

\bigskip
Доказательство  \hyperref[LocalLemma]{Локальной Леммы} можно посмотреть в \cite{Kozik}. В нашей модели случайные независимые векторы --- это пары величин  $(f(v),\sigma(v))$, $v\in V$, которые были присвоены каждой вершине $v$ гиперграфа $H$.  Для каждой вершины $v$ мы оцениваем вероятность всех типов всех Плохих событий и далее, суммируем их c соответствующими коэффициентами из (\ref{local:polynomial}). Для доказательства мы выбрали следующие параметры:

			\begin{equation}\label{choice:parameters}
			\tau_0=\frac 1{n+1},\;\;p=\frac{5\ln n}{n}.
			\end{equation}
			Сейчас мы переходим к анализу Плохих событий.
			
			
			\subsection{Анализ Плохих событий}
			
			Предположим, что Алгоритм не помог и по итогам его работы гиперграф $H$ все еще содержит одноцветные ребра. Обозначим через $A$ одно из подобных  одноцветных ребер в финальной раскраске. Пусть $T$ --- это $h$-дерево с корнем $A$. Напомним, что отношение смежности в $h$-дереве индуцируется отношением обвинения.
			
			\subsubsection{Плохое событие 1: много перекрашенных вершин}
			В качестве первого Плохого события  $\mathcal{B}_1$ возьмем событие, когда корень $h$-дерева  содержит хотя бы  $20e\ln n$ перекрашенных вершин. Это означает, что есть некоторое ребро $C$ гиперграфа $H$(корень $h$-дерева) такое, что выполнены одновременно следующие 4 условия:
			\begin{itemize}
				\item в процессе Алгоритма $C$ стало одноцветным ребром некоторого цвета  $\alpha$;
				\item каждая вершина $v\in C$ либо имела изначальный цвет  $f(v)=\alpha$ , либо изначальный цвет --- $f(v)=\alpha-1\;({\rm mod}\;r)$;
				\item число свободных вершин в $C$ хотя бы $20e\ln n$;
				\item все вершины с изначальным цветом  $\alpha-1$ свободные.
			\end{itemize}
			Вероятность события  $\mathcal{B}_1(C)$ может быть оценена следующим образом:
			\begin{align*}
			{\sf Pr}(\mathcal{B}_1(C))&=r\sum_{k\geqslant 20e\ln n}{n\choose k}\left(\frac {1}r\right)^{n-k}\left(\frac{2p}r\right)^{k}=
			r^{1-n}\sum_{k\geqslant 20e\ln n}{n\choose k}(2p)^k\leqslant\\
			&\leqslant r^{1-n}\sum_{k\geqslant 20e\ln n}\left(\frac{2enp}k\right)^k=r^{1-n}\sum_{k\geqslant 20e\ln n}\left(\frac{5e}k\right)^k\leqslant\\
			&\leqslant r^{1-n}\sum_{k\geqslant 20e\ln n}\left(\frac 12\right)^k\leqslant r^{1-n}2^{1-20e\ln n}\leqslant 2\,r^{1-n}n^{-10}.
			\end{align*}
			Поэтому, для каждой вершины $v$, имеет место быть следующая оценка на полином из  \hyperref[LocalLemma]{Локальной Леммы}:
			\begin{align}\label{polynom:event1}
			w^1_v\left(\frac 1{1-\tau_0}\right)&=\sum_{C:\;v\in C}{\sf Pr}(\mathcal{B}_1(C))\left(\frac 1{1-\tau_0}\right)^{|C|}=\notag\\
			&\mbox{(поскольку число ребер   инцидентных  вершине  $v$ не превосходит  $\Delta(H)$)}\notag\\
			&=\sum_{C:\;v\in C}{\sf Pr}(\mathcal{B}_1(C))\left(1+\frac 1n\right)^{n}\leqslant \Delta(H)\cdot 2\,r^{1-n}n^{-10} e\leqslant\notag\\
			&\mbox{(используя условие  \ref{bound:new})}\notag\\
			&\leqslant \frac{1}{(2e)^4}\,r^{n-b}n\cdot 2\,r^{1-n}n^{-10} e=\frac 1{(2e)^3} r^{1-b}n^{-9}\leqslant \frac{1}{10(n+1)}.
			\end{align}
		Будем узел $C$ называть \emph{ вырожденным}, если произошло событие  $\mathcal{B}_1(C)$. Далее, мы рассматриваем $h$-деревья без вырожденных узлов.
			
			\subsubsection{Удаление повторяющихся ребре}
			
			Предположим, что $T$ --- это $h$-дерево с корнем $A$ и в $T$ нет вырожденных узлов. Для каждого узла $C\in T$  введем понятие $h$-поддерева $N(C)$, состоящего из всех узлов $B$ $h$-дерева $T$, кратчайший путь из которых до корня проходит через $C$.

			Отношение смежности в $h$-дереве индуцируется отношением обвинения. Так, если узел  $C$  обвиняет узел $F$, тогда ребро $C$ содержит вершину  $v(F)$, которая обвиняет ребро  $F$, поэтому $v(F)\in C\cap F$. В случае простых гиперграфов такая вершина  $v(F)$ однозначно определена для  ребер $C$ и $F$, потому что по определению простого гиперграфа --- в пересечении любых двух различных ребер может быть не более одной общей вершины. В случае  $b$-простых гиперграфов такое свойство уже не выполняется, здесь размер  $C\cap F$ может быть больше 1. Однако, как утверждает следующая лемма, обвиняющая вершина по-прежнему может быть однозначно определена. 
			
			\begin{proposition}\label{blaming}
				Пусть узлы  $F_1,\ldots,F_s$ --- потомки первого порядка узла $C$. Тогда, обвиняющие вершины  $v(F_1),\ldots,v(F_s)\in C$ однозначно восстанавливаются по структуре графа $T$, т.е. существует взаимно-однозначное соответствие между множеством ребер и множеством перекрашенных вершин.
			\end{proposition}
			\begin{proof}
				Узел-предок $C$ был одноцветным некоторого цвета $\alpha$ на некотором шаге Алгоритма перекраски. Поэтому есть вершина $u\in C$, которая была перкрашена в $C$ последней (до того как ребро $C$ стало одноцветным цвета $\alpha$). В свою очередь, вершина $u$ должна была обвинить некоторое ребро $F_i$, которое к  моменту перекраски $u$ должно было быть одноцветным, цвета  $\alpha-1$. Следовательно, $|C\cap F_i|=1$ и $u=C\cap F_i=v(F_i)$. Удалим теперь вершину $u$ из $C$ и повторим предыдущие рассуждения для оставшихся вершин. Таким образом мы установим взаимно однозначное соответствие между $F_1,\ldots,F_s$ и $v(F_1),\ldots,v(F_s)$.
			\end{proof}
			
			Предположим, что $C$ и $D$ различные узлы в $T$, но $C=D$ как ребра гиперграфa $H$. Такая ситуация происходит, когда обвиняющие вершины   $v(C)$ и $v(D)$ совпадают. В дальнейшем, такие совпадающие ребра $C$ и $D$ будем называть \emph{копиями}. В случае простых гиперграфов такая ситуация может быть разрешена путем рассмотрения  простых циклов в гиперграфе  $H$. В случае  $b$-простых гиперграфов такой подход не сработает, потому что у нас нет  ограничений на 2-костепени в $H$. Поэтому будем действовать другим путем.
			
			Заметим, что если узлы  $C$ и $D$ совпали, то $h$- поддеревья  $N(C)$ и  $N(D)$ тоже совпадают. Таким образом,  свойство иметь копию наследуется. Исходя из этого, будем говорить, что вершина  $v$ \emph{специальная}, если есть два различных узла $C$ и  $D$ в  $h$-дереве $T$ такие, что
			\begin{itemize}
				\item $C$ и $D$ совпадают как ребра гиперграфа;
				\item $v=v(C)$ и $v=v(D)$;
				\item родители $C$ и $D$ в $h$-дереве не совпадают как ребра  гиперграфа $H$.
			\end{itemize}
			Определение специальной вершины в $h$-поддереве абсолютно аналогичное.
			
			\bigskip
			Для заданного $h$-дерева (или $h$-поддерева) $T$, определим операцию удаления повторяющихся ребер.
			\begin{enumerate}
				\item Зафиксируем некоторый порядок  $\zeta'$ на множестве ребер  $H$. Будем нумеровать узлы $h$-дерева $T$ по возрастанию расстояния до корня $A$, а если расстояния совпали для каких-то двух узлов, то нумеруем в соответствии с порядком $\zeta'$, если приэтом номера  $\zeta'$ совпали (т.е. мы имеем случай совпадающих ребер), то занумеруем их в соответствии с номерами их предков в  $h$-дереве. Обозначим через $\zeta$ финальный порядок на множестве узлов $T$. 
				\item Будем теперь  рассматривать узлы в соответствии с порядком  $\zeta$.
				\item Для текущего узла $C$, если имеется совпадающий узел с ним узел $D$(назовем его копией $C$), тогда удаляем из  $h$-дерева все копии  $C$ вместе со всеми их потомками (т.е. удаляем $D$ вместе с  $N(D)$, если $D$ копия $C$.).
				\item Повторяем предыдущий шаг до тех пор пока  возможно.
			\end{enumerate}
			Обозначим через $O(T)$ новое $h$-дерево, которое получилось после операции $O$. Ясно, что в $O(T)$ нет совпадающих ребер. Для удобства, такие  $h$-деревья будем называть \emph{правильными}. Применяя операцию $O$ мы можем сделать все $h$-деревья правильными. Поэтому всюду далее рассматриваем только правильные $h$-деревья.
			
			
			\subsubsection{Плохое событие 2: $b$-непересекающиеся правильные $h$-деревья}
			
			Пусть теперь $T_1=O(T)$ правильное $h$-дерево с корнем $A$. Далее, ребро  $C$ будем называть \emph{плохим} ребром, если 
		$$
		\left|C\cap \bigcup_{B\in T_1\setminus N(C)}B\right|\geqslant b+1,
		$$
			т.е. $C$ имеет не менее, чем $b+1$ общую вершину с объединением ребер, которые не входят в поддерево $N(С)$. Аналогичным образом можно ввести понятие плохого ребра в любом $h$-поддереве. 
			
			\bigskip
			\emph{Прямым путем} в корневом дереве будем называть кратчайший путь, соединяющий вершину с корнем. Возможно 2 случая:
			\begin{enumerate}
				\item В $T_1$ есть прямой путь, на котором лежат все плохие ребра.
				\item В $T_1$ такого пути нет.
			\end{enumerate} 
				
			Рассмотрим первую альтернативу: пусть $C_m$ это плохое ребро, которое лежит дальше всех от корня  $A$. Пусть $(C_m,C_{m-1},\ldots,C_0=A)$ прямой путь от $C_m$ до $A$, и все плохие ребра содержатся в этом пути. Предположим также, что для каждого $j=0,\ldots,m-1$,
			\begin{equation}\label{condition:path}
			\left|C_j\cap \bigcup_{i=j+1}^{m}C_i\right|\leqslant b.
			\end{equation}
			Правильное $h$-дереово (или $h$-поддерево) будем называть  $b$-\emph{непересекающемся} если есть прямой путь , содержащий все плохие ребра $h$-дерева, и выполняется условие \eqref{condition:path}. Если в $h$-дереве нет плохих ребре, то мы можем считать, что прямой путь состоит ровно из одного ребра --- корня $A$.
			Таким образом в Плохом событии $\mathcal{B}_2(T)$ мы рассматриваем случай $b$-непересекающихся правильных $h$-деревьев $T$.
			
			Пусть величина $t$ --- это размер дерева $T$. Тогда имеет место быть следующее утверждение.
			
			\begin{proposition}\label{bdisjoint:property1}
 Число  вершин гиперграфа $H$, которые попали в $T$, не меньше, чем  $n+(n-b)(t-1)$.
			\end{proposition}
			\begin{proof}
			
	 Обозначим через $(C_m,\ldots,C_0)$ путь, который содержит все плохие ребра. Для удобства перенумеруем узлы $T$  следующим образом: сначала идут узлы $C_m,\ldots,C_0$, а потом все остальные узлы по возрастанию расстояния до корневого узла $C_0$. Можно заметить, что каждый узел (кроме узлов $C_m,\ldots,C_0$) имеет номер меньше, чем любой его потомок и каждое ребро гиперграфа, отвечающее этому узлу имеет не более $b$ общих вершин со всеми ребрами, которые отвечают  предыдущим узлам. Согласно свойству  \eqref{condition:path} это же выполняется для узлов $C_m,\ldots,C_0$. 
Учитывая, что размер $T$ равен $t$ получаем, что общее число вершин гиперграфа хотя бы  $n+(n-b)(t-1)$
			\end{proof}
			
			\bigskip
			Напомним, что в  $T$ нет вырожденных ребер. Поэтому каждое ребро $C$ содержит не больше, чем  $10e\ln n$ вершин, которые были перекрашены до того как ребро  $C$ стало одноцветным некоторого цвета  $\alpha$ . Будем называть такой цвет  $\alpha$  \emph{доминантным} цветом  $C$. Заметим, что в изначальной раскраске $f$ хотя бы  $n-10e\ln n$ вершин ребра  $C$ уже имеет  доминантный цвет $\alpha$.
			
			Конструкция  $h$-дерева обеспечивает важную вещь: если известен итоговый цвет $\alpha$ корня $A$ $h$-дерева $T_1$, то изначальные цвета всех вершин гиперграфа, входящих в $T$, однозначно определяется по графу $T_1$. Это непосредственно следует из Алгоритма перекраски. Второе утверждение говорит, что это же верно и для всех $h$-поддеревьев.
			
			\begin{proposition}\label{bdisjoint:property2}
				Если зафиксировать доминантный цвет корня  $A$, но изначальные цвета всех вершин гиперграфа, которые попали в  $T_1=O(T)$, одназначно определяются.
			\end{proposition}
			\begin{proof}
				Для фиксированного доминантного цвета корня  $A$, доминантные цвета всех остальных узлов однозначно определены. Согласно операция удаления повторяющихся ребер (операция $O$) потомки корня  $A$ не удаляются. Поэтому согласно доказанному утверждению   \ref{blaming} множество обвиняющих вершин  $v(F_1),\ldots,v(F_s)$ будет однозначно определено потомками $F_1,\ldots,F_s$. Таким образом, цвета $A$ восстанавливаются.
				
				Далее, занумеруем оставшиеся узлы в соответствии с нумерацией $\zeta$ и положим $\mathcal{R}(T_1)=\{v(F_1),\ldots,v(F_2)\}$. Тогда для каждого следующего узла $C$,
				\begin{itemize}
					\item нам известны все цвета всех его общих вершин с предками. Добавим их в  $\mathcal{R}(T_1)$;
					\item нам известны все цвета в множестве  $\mathcal{R}(T_1)\cap C$;
					\item изначальные цвета всех оставшихся вершин равны доминантному цвету $C$.
				\end{itemize}
				Действительно, если изначальный цвет вершины  $w$ не равен доминантному цвету  $C$, тогда эта вершины обвиняет другое ребро $D$, и потомки  $C$ находятся в  $h$-дереве. Может так оказаться, что  $D$ было удалено в результате операции $O$, но в таком случае  $T_1$ содержит узел  $D'$, являющийся копией  $D$. Родители $D'$ содержат вершину  $w$ и имеет номер $\zeta$ меньше, чем номер $C$, поэтому  $w\in\mathcal{R}(T_1)$.
			\end{proof}
			
			\bigskip
			Пусть $\mathcal{R}(T_1)$ обозначает множество всех перекрашенных вершин в правильном  $h$-дереве $T_1$ с корнем $A$. Приведенное выше утверждение показывает, что это множество однозначно определяется через ребра и их пересечения. Более того, повторяя доказательство утверждения   \ref{blaming} мы можем получить, что для каждого узла  $C\ne A$ его обвиняющая вершина  $v(C)$ также однозначно определена.
			
			\begin{proposition}\label{bdisjoint:property3}
				Пусть $A_0=A,A_1,\ldots,A_{t-1}$ --- это узлы  $T_1$. Тогда в каждом  $A_i$ найдется подмножество вершин  $R_i\subset A_i$, такое что
				\begin{enumerate}
					\item $|R_i|\geqslant n-20e\ln n-b$ для любого $i=1,\ldots,t-1$;
					\item множества $R_0,\ldots,R_{t-1}$ попарно не пересекаются , $R_i\cap R_j=\emptyset$, $i\ne j$;
					\item все вершины в  $R_i$ в изначальной раскраске $f$ покрашены в доминантный цвет ребра $A_i$ ;
					\item вершина  $v(A_i)$ принадлежит $R_i$ и это первая вершина в $R_i$ (в соответствии с нумерацией $\sigma$) для каждого $i>0$;
					\end{enumerate}
					\end{proposition}
					\begin{proof}
					Без потери общности, предположим, что  $(A_m,\ldots,A_0)$ прямой путь, который содержит все плохие ребра. Определим множество $R_i$ для $i=0,\ldots,m$, следующим образом:
				\begin{equation}\label{definition:r_i_1}
				R_i=\{v(A_i)\} \cup A_i\setminus\left(\mathcal{R}(T_1)\cup\bigcup_{j=i+1}^{m} A_j\right).
				\end{equation}
				Здесь мы предполагаем, что  $\{v(A_0)\}$ равно пустому множеству. Для всех $i>m$, определим
				\begin{equation}\label{definition:r_i_2}
				R_i=\{v(A_i)\} \cup A_i\setminus\left(\mathcal{R}(T_1)\cup\bigcup_{F\in T_1\setminus N(A_i)}F\right).
				\end{equation}
				Так как каждое ребро $A_i$ невырожденное, то для $A$ верно, что  $|A_i\cap \mathcal{R}(T_1)|\leqslant 20e\ln n$. Для $i>m$, $A_i$ не плохое ребро, поэтому $|A_i\cap \bigcup_{F\in T_1\setminus N(A_i)}F|\leqslant b$. Таким образом, $|R_i|\geqslant n-20e\ln n-b$. Для $i\leqslant m$, необходимое соотношение следует из  \eqref{condition:path}.
				
				Предположим, что узлы  $A_{m+1},\ldots,A_{t-1}$ занумерованы по возрастанию их расстояния до корня. Обозначим через $R'_i=R_i\setminus\{v(A_i)\}$. Для $j<i$,  множество $R'_i$ может иметь непустое пересечение с $A_j$ только тогда, когда  $A_j$ родитель $A_i$. Но $R'_j$ не имеет пересечений с детьми  $A_j$, потому что  все их обвиняющие вершины попадают в  $\mathcal{R}(T_1)$. Множества $R'_1,\ldots,R'_m$ также не пересекаются, это следует из определения  \eqref{definition:r_i_1}. Если $i\leqslant m<j$, тогда $A_i$ не могут быть потомками  $A_j$, отсюда  $R'_i$ и $R'_j$ не могут пересекаться. Следовательно, все множества $R'_0,\ldots,R'_{t-1}$ не пересекаются. Из определения \eqref{definition:r_i_1} и \eqref{definition:r_i_2} следует, что все эти множества не пересекаются с  $\mathcal{R}(T_1)$, поэтому добавив вершины  $v(F_i)$ в непересекающиеся множества  $\mathcal{R}(T_1)$ мы по-прежнему будем иметь непересекающиеся множества  $R_0,\ldots,R_{t-1}$.
				
				Поскольку $R_i$ не пересекается с детьми  $A_i$, в изначальной раскраске $f$ все вершины $R_i$ должны окрашены в доминантный цвет ребра $A$. Более того, Алгоритм говорит, что вершина  $v(A_i)$ может обвинить $A_i$ тогда и только тогда, когда она является первой неперекрашенная вершиной в момент, когда   $A_i$ стало одноцветным. Итак, $v(A_i)$ --- это  первая вершины в $R_i$.
			\end{proof}
			
			\bigskip
			Сейчас мы уже можем оценить вероятность событий  $\mathcal{B}_2(T_1)$, т.е. события когда $T_1$ это  $b$-непересекающееся правильное  $h$-дерево без вырожденных ребер.
			\begin{proposition}\label{bdisjoint:property4}
				Для каждого $b$-непересекающегося правильного  $h$-дерева $T$ размера $t$ без вырожденных ребер,
				\begin{equation}\label{prob:event2}
				{\sf Pr}\left(\mathcal{B}_2(T)\right)\leqslant r^{1-n-(n-b)(t-1)}\left(\frac 1{n-20e\ln n-b}\right)^{t-1}(1-p)^{n-20e\ln n}.
				\end{equation}
			\end{proposition}
			\begin{proof} Согласно доказанному утверждению  \ref{bdisjoint:property2} вероятность того, что для данного зафиксированного доминантного цвета корня все остальные вершины гиперграфа из $T_1$  будут иметь заранее определенные цвета, равна to $r^{-m}$, где $m$ это число вершин в  $T_1$. Из утверждения \ref{bdisjoint:property1} следует, что $m\geqslant n+(n-b)(t-1)$.
				
				Пусть $A_0$ это корень. Согласно утверждению  \ref{bdisjoint:property3}, для любого $A_i\in T_1$, $A_i\ne A_0$, вершина  $v(A_i)$ первая в множестве  $R_i$, размер которого  хотя бы  $n-20e\ln n-b$. ВСе такие множества являются попарно непересекающимися, поэтому данные события независимы и вероятность может быть оценена следующим образом $(1/(n-20e\ln n-b))^{t-1}$.
				
				Наконец, все вершины из специального множества $R_0\subset A_0$ в изначальной раскраске $f$ имеют доминантный цвет $\alpha$ и все они несвободные. С другой стороны, Алгоритм не закончился и ребро  $A_0$ не может быть одноцветным в финальной раскраске. Вероятность этого события равна   $(1-p)^{|R_0|}\leqslant (1-p)^{n-20e\ln n-b}$. Для завершения доказательства остается заметить, что  $R_0$ не пересекается с остальными множествами  $R_i$.
				
				Все три события независимы и вместе  составляют событие   $\mathcal{B}_2(T)$ . Поэтому, имеет место быть оценка \eqref{prob:event2}.
			\end{proof}
			
			\bigskip
			Последнее утверждение этого параграфа дает оценку на число конфигураций, содержащих фиксированную вершину и образующих $h$-дерево. Для обоснования этого факта мы повторим  доказательство утверждение 6 в \cite{KozikShab}.
			
			\begin{proposition}\label{bdisjoint:property5}
				Пусть $H=(V, E)$ --- некоторый гиперграф с максимальной степенью ребра  $\Delta(H)$ и пусть $v\in\ V$ произвольная вершина. Тогда число $h$-деревьев размера  $t$, содержащих вершину  $v$ не превосхоит $(4\Delta(H))^{t}$.
			\end{proposition}
			\begin{proof}
			Воспользуемся верхней оценкой числа корневых деревьев с непронумерованными вершинами:
\begin{equation}
4^t/t
\end{equation}
После того как выбрана структура (выбрано корневое дерево) есть $t$ способов выбрать узел $h$-дерева, который будет содержать фиксированную вершину $v$ гиперграфа $H$. После этого остается поставить в соотвествие каждому узлу дерева ребро гиперграфа. Достаточно действовать по следующему правилу: для каждого непоределенного еще узла $X$, который смежен с  уже поределенным узлом  $Z$ выбираем ребро, которое пересекает  $Z$. Ясно, что  $v$ принадлежит не больше чем  $(\Delta(H)+1)$  ребру гиперграфа, а выбор каждого следующего ребра возможен не более чем $\Delta(H)$ способами. Таким образом, получаем
\begin{equation}
t\cdot(\Delta(H))^{t-1}\cdot(\Delta(H)+1)\cdot\frac{4^t}{t}\sim (4\Delta(H))^t
\end{equation}
\end{proof}
			
			\bigskip
			Теперь все готово для того, чтобы получить нужную оценку на локальный полином для Плохого события 2.
			\begin{align}\label{polynom:event2}
			w^2_v\left(\frac 1{1-\tau_0}\right)&=\sum_{T_1:\;v\in T_1}{\sf Pr}(\mathcal{B}_2(T_1))\left(\frac 1{1-\tau_0}\right)^{|{\rm vln}(\mathcal{B}_2(T_1))|}\leqslant\notag\\
			&\leqslant\sum_{t=1}^{|E|}\sum_{T_1:\;v\in T_1,\;|T_1|=t}{\sf Pr}(\mathcal{B}_2(T_1))\left(1+\frac 1n\right)^{|{\rm vln}(\mathcal{B}_2(T))|}\leqslant\notag\\
			&\mbox{(используя \eqref{prob:event2} и оценку $|{\rm vln}(\mathcal{B}_2(T_1))|\leqslant nt$)}\notag\\
			&\leqslant\sum_{t=1}^{|E|}\sum_{T_1:\;v\in T_1,\;|T_1|=t}r^{1-n-(n-b)(t-1)}\left(\frac 1{n-20e\ln n-b}\right)^{t-1}(1-p)^{n-20e\ln n-b}e^{t}\leqslant\notag\\
			&\mbox{(предполагая  $n$ достаточно большим и используя Утверждение \ref{bdisjoint:property5} с условием  \eqref{bound:new})}\notag\\
			&\leqslant\sum_{t=1}^{|E|}(4\Delta(H))^tr^{1-n-(n-b)(t-1)}\left(\frac 2{n}\right)^{t-1}(1-p)^{n-20e\ln n-b}e^{t}\leqslant\notag\\
			&\leqslant\sum_{t=1}^{|E|}\left(\frac {4}{(2e)^4}\right)^tn^t\left(\frac 2{n}\right)^{t-1}\left(1-\frac{5\ln n}{n}\right)^{n-20e\ln n}e^{t}\leqslant\notag\\
			&\leqslant n\cdot n^{-5+o(1)}\sum_{t=1}^{|E|}\left(\frac {8e}{(2e)^4}\right)^t=n^{-4+o(1)}\leqslant \frac{1}{10(n+1)}.
			\end{align}
			
			\subsubsection{Плохое событие 3: большое $b$-непересекающееся правильное  $h$-поддерево}
			
			Сейчас мы предполагаем, что правильное $h$-дерево $T_1=O(T)$ не является $b$-непересе-\\
			-кающемся, но однако имеет $h$-поддерево $T'$, такое что 
			 $T'_1=O(T')$ является $b$-непересе-\\
			 -кающемся правильным  $h$-поддеревом размера хотя бы  $\ln n$, $t=|T'_1|\geqslant \ln n$. Пусть $\mathcal{B}_3(T'_1)$ соответствующее событие. Ранее сформулированные утверждения  \ref{bdisjoint:property1}--\ref{bdisjoint:property3} также применимы к $h$-поддеревьям. Единственным отличием является оценка вероятности.
			\begin{proposition}\label{subtree:property1}
				Для каждого $b$-непересекающегося без вырожденных ребер правильного  $h$-поддерева $T'$ размера $t$,
				\begin{equation}\label{prob:event3}
				{\sf Pr}\left(\mathcal{B}_3(T'_1)\right)\leqslant r^{1-n-(n-b)(t-1)}\left(\frac 1{n-20e\ln n-b}\right)^{t-1}.
				\end{equation}
			\end{proposition}
			\begin{proof}Первые два события из $\mathcal{B}_2(T_1)$ уже доказаны в утверждении \ref{bdisjoint:property4}. Но теперь мы не можем сказать, что большинство  вершин корня должны быть несвободными (известно только, что хотя бы одна свободная), поэтому мы пропускаем третье событие для  $\mathcal{B}_2(T_1)$. Объединение первых двух событий из \eqref{prob:event3} дает требуемую оценку вероятности \eqref{prob:event3}.
			\end{proof}
			
			\bigskip
			Число $h$-поддеревьев фиксированного размера, которые содержат фиксированную вершину  может быть оценено также как в утверждении  \ref{bdisjoint:property5}.
			Итак, мы выписываем оценку на локальный полином для Плохого события 3.
			\begin{align}\label{polynom:event3}
			w^3_v\left(\frac 1{1-\tau_0}\right)&=\sum_{T'_1:\;v\in T'_1}{\sf Pr}(\mathcal{B}_3(T'_1))\left(\frac 1{1-\tau_0}\right)^{|{\rm vln}(\mathcal{B}_3(T'_1))|}\leqslant\notag\\
			&\leqslant\sum_{t\geqslant \ln n}\sum_{T'_1:\;v\in T'_1,\;|T'_1|=t}{\sf Pr}(\mathcal{B}_3(T'_1))\left(1+\frac 1n\right)^{|{\rm vln}(\mathcal{B}_3(T'_1))|}\leqslant\notag\\
			&\mbox{(используя \eqref{prob:event3} и оценку $|{\rm vln}(\mathcal{B}_3(T'_1))|\leqslant nt$)}\notag\\
			&\leqslant\sum_{t\geqslant \ln n}\sum_{T'_1:\;v\in T'_1,\;|T'_1|=t}r^{1-n-(n-b)(t-1)}\left(\frac 1{n-20e\ln n-b}\right)^{t-1}e^{t}\leqslant\notag\\
			&\mbox{(предполагая  $n$ достаточно большим и пользуясь условием \eqref{bound:new})}\notag\\
			&\leqslant\sum_{t\geqslant \ln n}(4\Delta(H))^tr^{1-n-(n-b)(t-1)}\left(\frac 2{n}\right)^{t-1}e^{t}\leqslant\notag\\
			&\leqslant\sum_{t\geqslant\ln n}\left(\frac {4}{(2e)^4}\right)^tn^t\left(\frac 2{n}\right)^{t-1}e^{t}\leqslant
			n\cdot \sum_{t\geqslant \ln n}\left(\frac {8e}{(2e)^4}\right)^t\leqslant\notag\\
			&\leqslant n\cdot (2e^3)^{1-\ln n}\leqslant n^{-3+o(1)}\leqslant \frac{1}{10(n+1)}.
			\end{align}
			
			
			\subsubsection{Плохое событие 4: маленькое $b$-непересекающееся \\ правильное $h$-поддерево}
			
		Пусть $T$ --- это такое $h$-дерево, что  $O(T)$ не является $b$-непересекающемся. Рассмотрим в нем наименьшее поддерево $Y$, такое что  $Y'=O(Y)$ также не является $b$-непересекающемся. Пусть $A$ --- это корень $Y$ и пусть $F_1,\ldots,F_s$ --- это дети  $Y$. Тогда любое поддерево $N(F_i)$ обладает тем свойством, что  $O(N(F_i))$ является $b$-непересекающемся. (иначе бы $Y$ не было наименьшим). Если размер  $O(N(F_i))$ больше, чем  $\ln n$ тогда мы попадает в уже разобранный случай Плохого события 3. Поэтому будем считать, что размер $O(N(F_i))$ меньше, чем  $\ln n$. Поскольку $s\leqslant 20e\ln n$ (напомним, что у нас нет вырожденных ребер в $T$), размер $Y'$ также ограничен:
			\begin{equation}\label{nobdisjoint:size}
			|Y'|\leqslant \sum_{i=1}^s|O(N(F_i))|+1\leqslant (20e\ln n)\ln n+1\leqslant 30e(\ln n)^2.
			\end{equation}
			В данном случае соотношение  \eqref{nobdisjoint:size} может и не выполняться, поскольку некоторые ребра $Y$ могли быть удалены в $O(Y)$. 
			
			\bigskip
			Если $Y'$ не является  $b$-непересекающемся, тогда
			\begin{itemize}
				\item[(a)] либо есть прямой путь  $C_m,\ldots,C_1,C_0=A$, который содержит все плохие ребра, и при этом соотношение \eqref{condition:path} не выполняется;
				\item[(b)] либо такого пути нет и поэтому найдутся два плохих ребра   $C$ и $D$, такие что  $C\notin N(D)$ и $D\notin N(C)$.
			\end{itemize}
			Обозначим данное событие через $\mathcal{B}_4(Y')$ . Тогда верна следующая оценка вероятности для $\mathcal{B}_4(Y')$.
			
			\begin{proposition}\label{badsubtree:property1}
				Пусть размер $Y'$ равен $t$. Тогда,
				\begin{equation}\label{prob:event4}
				{\sf Pr}\left(\mathcal{B}_4(Y')\right)\leqslant r^{1-t(n-bt)}.
				\end{equation}
			\end{proposition}
			\begin{proof} Узлы  $Y'$ не совпадают как ребра гиперграфа  $H$, т.к. мы удалили все копии с помощью операции  $O(Y)$. Ввиду того, что $H$ является $b$-простым гиперграфом, каждый узел как ребро гиперграфа $H$ содержит  хотя бы  $n-bt$ вершин, которые присутствуют только в нем. Поэтому, общее число вершин хотя бы $t(n-bt)$. Конструкция  $h$-поддерева обеспечивает то, что для данного доминантного цвета, цвета всех остальных вершин однозначно определяются. Аналогичные рассуждения верно и после проведения операции  $O$ (смотрите утверждение  \eqref{bdisjoint:property3}). Отсюда следует оценка  \eqref{prob:event4}.
			\end{proof}
			
			\bigskip
		  Далее мы получим оценку на число $h$-поддеревьев, которые не являются $b$-непересе-
		  -кающимися и  содержат некоторую фиксированную вершину $v$ гиперграфа $H$. 
			
			\begin{proposition}\label{badsubtree:property2}
				Число $b$-непересекающихся  $h$-поддеревьев размера  $t$, в которых нет  вырожденных ребер и которые содержат некоторую  фиксированную вершину  $v$, не превосходит
				$$
				2\cdot 4^tt^2(\Delta(H))^{t-1}{nt\choose b+1}.
				$$
			\end{proposition}
			\begin{proof}Количество корневых деревьев размера $t$ оценивается числом  $4^t/t$.
				
				Рассмотрим случай (a). Напомним, что мы имеем прямой путь $C_m,\ldots,C_1,C_0$, с корнем $C_0$, который   содержит все плохие ребра. В нашем случае условие  \eqref{condition:path} не выполнено. Мы рассмотрим три конкретных узла: узел $D$, который содержит вершину  $v$, узел $C_m$ и какой-нибудь узел  $C_j$, $j<m$, для которого условие  \eqref{condition:path} не выполняется (зафиксировать такие три ребра можно не более, чем $t^3$ способов). Напомним, что  $C_m$ --- это плохое ребро. Узел $D$ может быть выбран не более, чем  $\Delta(H)$ способами. Теперь, если $C_m$ не входит в прямой пусть, содержащий  $D$ и корень $C_0$, тогда, до определения $C_m$ (т.е. до сопостовления узлу $C_m$ некоторого ребра гиперграфа $H$), мы можем определить  все  узлы, которые не принадлежат  $N(C_m)$. Достаточно действовать по следующему правилу: для каждого непоределенного еще узла $X$, который смежен с  уже поределенным узлом  $Z$ выбираем ребро, которое пересекает  $Z$. Каждый раз мы имеем не более, чем  $\Delta(H)$ вариантов . После этого мы выбраем $C_m$. Поскольку наш гипепрграф  $b$-простой и $C_m$ плохое ребро, то такое ребро однозначно определяется выбором  $b+1$ вершины из множества $\bigcup_{F\in Y'\setminus N(C_m)}F$. Это множество уже определено и его размер не больше, чем  $nt$, поэтому $C_m$ может быть определено не более, чем  ${nt\choose b+1}$ способами. Все оставшиеся узлы в $N(C_m)$ могут быть определены используя обычное правило, и это дает не более, чем  $\Delta(H)$ вариантов.
				
				Если  $C_m$ содержится в прямом пути, содержащем  $D$ и корень $C_0$, тогда мы можем определять узлы пути по обычному правилу до тех пор пока не достигнем   $C_j$. Согласно сделанному дополнению к  \eqref{condition:path} узел $C_j$ может быть определен не более, чем  ${nt\choose b+1}$ способами, потому что это ребро должно содержать хотя бы  $b+1$ общую вершину с уже выбранными ребрами $C_m,\ldots,C_{j+1}$.
				
				\bigskip
				В случае  (b) у нас есть два плохих ребра $C$ и $F$, которые не лежат ни в одном прямом пути, идущем до корня.Снова мы можем рассмотреть три конкретных узла: узел $D$, который содержит вершину  $v$, узел $C$ и узел  $F$. Тогда либо мы можем определить все узлы, которые не попадают в  $N(C)$ до того как потребуется определить  $C$, либо мы можем определить все узлы, которые не попадают в $N(F)$ до того как потребуется определить  $F$. Действительно, хотя бы один из узлов  $C$ или $F$ не лежит на прямом пути, соединяющем другой узел с корнем. Пусть это будет узел  $C$. Снова мы пользуемся обычное правило: для каждого неопределенного еще узла $X$, который смежен с  уже определенным узлом  $Z$ выбираем ребро, которое пересекает  $Z$. Каждый раз мы имеем не более, чем  $\Delta(H)$ вариантов . После этого мы выбраем $C$. Поскольку наш гиперграф  $b$-простой и   $C$ плохое ребро, то такое ребро однозначно определяется выбором  $b+1$ вершины из множества $\bigcup_{F'\in Y'\setminus N(C)}F'$. Это множество уже определено и его размер не больше, чем  $nt$, поэтому $C$ может быть определено не более, чем  ${nt\choose b+1}$ способами. Все оставшиеся узлы в $N(C)$ могут быть определены используя обычное правило, и это дает не более, чем  $\Delta(H$ вариантов.
		    \end{proof}
			
			Итак, мы получаем следующую оценку для локального полинома Плохого события 4:
			\begin{align}\label{polynom:event4}
			w^4_v\left(\frac 1{1-\tau_0}\right)&=\sum_{Y':\;v\in Y'}{\sf Pr}(\mathcal{B}_4(Y'))\left(\frac 1{1-\tau_0}\right)^{|{\rm vln}(\mathcal{B}_4(Y'))|}\leqslant\notag\\
			&\mbox{(используя \eqref{nobdisjoint:size})}\notag\\
			&\leqslant\sum_{t\leqslant 30e(\ln n)^2}\sum_{Y':\;v\in Y',\;|Y'|=t}{\sf Pr}(\mathcal{B}_4(Y'))\left(1+\frac 1n\right)^{|{\rm vln}(\mathcal{B}_4(Y'))|}\leqslant\notag\\
			&\mbox{(используя \eqref{prob:event4} и оценивая  $|{\rm vln}(\mathcal{B}_4(Y'))|\leqslant nt$)}\notag\\
			&\leqslant\sum_{t\leqslant 30e(\ln n)^2}\sum_{Y':\;v\in Y',\;|Y'_1|=t}r^{1-t(n-bt)}e^{t}\leqslant\notag\\
			&\mbox{(предполагая  $n$ достаточо большим и используя условие \eqref{bound:new})}\notag\\
			&\leqslant\sum_{t\leqslant 30e(\ln n)^2}2\cdot4^t(\Delta(H))^{t-1}t^2{nt\choose b+1}r^{1-t(n-bt)}e^{t}\leqslant\notag\\
			&\leqslant\sum_{t\leqslant 30e(\ln n)^2}8\left(\frac {4}{(2e)^4}\right)^{t-1}t^2n^te^{t}(nt)^{b+1}r^{(n-b)(t-1)+1-t(n-bt)}\leqslant
			\notag\\
			&\leqslant\sum_{t\leqslant 30e(\ln n)^2}8e\left(\frac {1}{4e^3}\right)^{t-1}t^2n^t(nt)^{b+1}r^{b(t^2-t+1)+1-n}\leqslant
			\notag\\
			&\mbox{(поскольку $t=O((\ln n)^2)$ и $n$ велико по сравнению с $b$)}\notag\\
			&\leqslant\sum_{t\leqslant 30e(\ln n)^2}8e\left(\frac {1}{4e^3}\right)^{t-1} e^{O((\ln n)^3)}r^{O((\ln n)^2)-n}\leqslant
			\notag\\
			&\leqslant 2^{O((\ln n)^3)-n}\leqslant \frac{1}{10(n+1)}.
			\end{align}
			
			\subsection{Завершение доказательства Теоремы \ref{mntheorem3}}
			Для применения \hyperref[LocalLemma]{Локальной Леммы} мы должны проверить выполнимость достаточных условий \eqref{local:condition}. А именно, для каждой вершины  $v$, имеют место быть оценки \eqref{polynom:event1}, \eqref{polynom:event2}, \eqref{polynom:event3}, \eqref{polynom:event4} для локальных полиномов. Поэтому их сумма $w_v(z)=\sum_{i=1}^4w_v^i(z)$ также ограничена   
			\begin{align*}
			w_v\left(\frac{1}{1-\tau_0}\right)=\sum_{i=1}^4w_v^i\left(\frac{1}{1-\tau_0}\right)\leqslant \frac{4}{10(n+1)}<\frac{1}{n+1}=\tau_0.
			\end{align*}
			Из Локальной леммы следует, что с положительной вероятностью не произойдет ни одно из указанных Плохих событий. Следовательно, с положительной вероятностью Алгоритм построит правильную раскраску в $r$-цветов. Tеорема \ref{mntheorem3} доказана.
			
			
			\bigskip
			\section{Следствия}
			\subsection{Максимальная степень вершины}
		 Первое следствие устанавливает связь между максимальной степенью вершины $b$-простого гиперграфа и его хроматического числа. 
			\begin{corollary}\label{corollary:vertexdegree}
				Пусть фиксированы числа $r$ и $b$. Тогда существует число $n_0(b)$, такое, что всякий $b$-простой $n$-однородный гиперграф $H$ с $\chi(H)>r$ и $n>n_0(b)$  имеет  максимальную степень вершины не меньше, чем $1/(2e)^4r^{n-b}$.
			\end{corollary}
			\begin{proof} Из Теоремы \ref{mntheorem3} следует, что  $H$ содержит ребро  $A$ степени хотя бы  $1/(2e)^4n\cdot r^{n-b}$. Следовательно, в  $A$ есть вершина у которой степень хотя бы  $1/(2e)^4r^{n-b}$.
			\end{proof}
			
			
			
			\subsection{Число ребер}
			В \cite{KMRT} Косточка, Мубай,  Рёдль и Тетали предложили рассматривать задачу об оценке минимально возможного числа ребер в $b$-простом $n$-однородном гиперграфе с хроматическим числом больше, чем $r$. . Данную величину принято обозначать через $m(n,r,b)$ Авторы  \cite{KMRT} показали, что при фиксированных  $n$ и  $b$, функция $m(n,r,b)$ имеет порядок  $\Theta_{n,b}((r\ln r)^{1+1/b})$ как функция от  $r$. В данном работе мы рассмотрим противоположную ситуацию: $r$, $b$ фиксированы, а $n$ растет. Для данного случая Косточка и Кумбхат {KostKumb} показали, что 
			\begin{equation}\label{bound:kk_bsimple}
			r^{n(1+1/b)}n^{-\varepsilon(n)}\leqslant m(n,r,b)\leqslant c_1\,r^{n(1+1/b)}n^{2(1+1/b)},
			\end{equation}
			где $\varepsilon(n)>0$ медленно убывает к нулю при  $n\to+\infty$ и $c_1=c_1(b,r)>0$ не зависит от $n$. Позже, верхняя оценка в  \eqref{bound:kk_bsimple} была улучшена Косточкой и Рёдлем \cite{KR}, они доказали, что  
			\begin{equation}\label{bound:kr_bsimple}
			m(n,r,b)\leqslant c_2\,r^{n(1+1/b)}n^{1+1/b},
			\end{equation}
			где $c_2=c_2(b,r)>0$ не зависит от  $n$. Наилучшей нижней оценкой на сегодняшней день является оценка Козика \cite{Kozik}:
			\begin{equation}\label{bound:kozik_bsimple}
			m(n,r,b)\geqslant \Omega_{r,b}\left(\left(\frac{r^n}{\ln n}\right)^{1+1/b}\right).
			\end{equation}
			
			\bigskip
			Мы улучшили оценку \eqref{bound:kozik_bsimple} следующим образом.
			
			
			\begin{corollary}\label{corollary:m(n,r,b)}
				При фиксированных  $r\geqslant 2$, $b\geqslant 2$ и при достаточно большом  $n>n_0(b)$,
				\begin{equation}\label{bound:new_m(n,r,b)}
				m(n,r,b)\geqslant c\cdot r^{n(1+1/b)},
				\end{equation}
				где $c=c(r,b)>0$ зависит только от depends  $r$ и $b$.
			\end{corollary}
		\begin{proof}
			Для доказательства данного утверждения мы повторим рассуждения из \cite{Kozik}. Доказательство базируется на идеи, впервые предложенные Ловасом и Ердёшем и доработанные Косточкой и Кумбхатом.
			Пусть $H=(V,E)$ $b$-простой $n$ однородный гиперграф, который нельзя правильно раскрасить в $r$ цветов. Рассмотрим вспомогательный гиперграф $F^{b}(H)=(V,E')$, который получается из исходного гиперграфа удалением из каждого ребра первых $b$ вершин наибольшей степени. Полученный новый гиперграф является $(n-b)$ однородным, но по-прежнему остается  $r$-нераскрашиваемым и  $b$-простым.
			
			 Полагая параметр $n$ достаточно большим и используя доказанное следствие \ref{corollary:m(n,r,b)} мы можем , что в $F^{b}(H)=(V,E')$, а значит и в исходном гиперграфе $H=(V,E)$,  существует вершина $v$ cо степенью не меньше, чем   $d=1/(2e)^4 r^{n-2b}$. Обозначим множество инцидентных $v$ ребер за $F$, а множество всех удаленных вершин из $F$ за $Y$. Мощность множества $Y$ можно оценить через $d$. Для этого нужно заметить, что любое $b$ подмножество вершин из $Y$ вместе с вершиной $v$ содержится не больше чем в одном ребре и любое ребро из $F$ содержит некоторое $b$-подмножество $Y$.
			$$
			d\leqslant {|Y|\choose b}\leqslant |Y|^b.
			$$
			откуда следует, что $|Y|\ge d^{1/b}$
			Для удобства будем считать, что $m=\lceil d^{1/b}\rceil$. Для вершин $v_{1},v_{2},...,v_{m}$ из множества $|Y|$ определим последовательно числа $d_{1},d_{2},...,d_{m}$, где $d_{i}$ равно общему числу всех ребер, которые содержат $v_{i}$ и которые имеют не больше , чем $(b-1)$ общую вершину с множеством $\{v_{1},v_{2},...v_{i-1}\}$.  Нетрудно заметить, что выполнены следующие соотношения:
			$$
			\sum_{j=1}^md_j\geqslant \sum_{j=1}^m\left(d-{j-1\choose b}\right)\geqslant dm-{m\choose b+1}\geqslant d^{1+1/b}-\frac{m^{b+1}}{(b+1)!}\geqslant c_0\,d^{1+1/b},
			$$
			, где $c_0=c_0(b)>0$ зависит только от $b$.
			Поделив последнее значение на $b$, так как каждое ребро может участвовать не больше чем в $b$ суммах, мы получим искомый результат.
	        $$
	        |E|\geqslant \frac 1b \sum_{j=1}^md_j\geqslant \frac{c_0}b\,d^{1+1/b}\geqslant c(r,b)r^{n(1+1/b)}.
	        $$
		\end{proof}
		
			
			Заметим, что нижняя оценка  \eqref{bound:new_m(n,r,b)} is only $n^{1+1/b}$ раз меньше, чем верхняя оценка  \eqref{bound:kr_bsimple} для фиксированных  $r$, $b$ и большого $n$.
	
		
		
		
		
		
		
		
		
\newpage		
\section{Доказательство Теоремы \ref{mntheorem}} Пусть $n>5$, а $H=(V,E)$ --- $n$--однородный гиперграф. Для удобства будем считать, что число вершин $m$ четно, а число ребер меньше, чем $c\sqrt{n/\ln n}2^n$. Под случайной раскраской $C=C(K_{1},K_{2})$ будем понимать случайное разбиение множества вершин гиперграфа на две равные доли: $V=K_{1}\sqcup K_{2}, |K_{1}|=|K_{2}|$.

\begin{lemma}\label{lemma1}
	Пусть $H=(V,E)$ произвольный $n$--однородный гиперграф, в котором выполнены следующие соотношения:
	\begin{equation*}
	|E|<c\sqrt{n/\ln n} 2^{n},\qquad \qquad |V|<n(n-1)/\ln n.
	\end{equation*}
Тогда при $c<1/2$ для $H$ существует справедливая раскраска в два цвета.
\end{lemma}

\begin{proof} Рассмотрим случайную раскраску $C$ гиперграфа $H$. Тогда
	\begin{gather*}
	\Prob(\text{есть одноцветное ребро в $C$})\leq\sum_{e\in E}\frac{2\binom{m-n}{m/2-n}}{\binom{m}{m/2}}\\
	=|E|\frac{2^{-n+1}(1-2/m)...(1-2(n-1)/m)}{(1-1/m)...(1-(n-1)/m)}\leq\\
	 \leq 2c\left(\frac{n}{\ln n}\right)^{1/2}\frac{\exp(\ln(1-2/m)+...+\ln(1-2(n-1)/m))}{\exp(\ln(1-1/m)+...+\ln(1-(n-1)/m))}=\\
	=	2c \left(\frac{n}{\ln n}\right)^{1/2}\prod_{x=1}^{n-1}\exp\left(\ln(1-2x/m)-\ln(1-x/m)\right).
	\end{gather*}
	Из разложения натурального логарифма в ряд Тейлора следует, что $\ln(1-2x/m)-\ln(1-x/m)<-x/m$ при $x\in(0;1)$. Поэтому, складывая показатели степеней у произведения экспонент, окончательно получаем:
	\begin{gather*}
	\Prob(\text{есть одноцветное ребро в $C$})\leq 2c \left(\frac{n}{\ln n}\right)^{1/2}e^{-n(n-1)/2m}\leq 2c\frac{1}{\sqrt{\ln n}}<1.
	\end{gather*}
	Следовательно, с положительной вероятностью случайная раскраска $C$ является справедливой раскраской. Лемма \ref{lemma1} доказана.
\end{proof}
Таким образом, нам остается рассмотреть гиперграфы, в которых число вершин $m$ больше, чем $n(n-1)/\ln n$.

\bigskip
Рассмотрим случайную величину $X$, равную числу одноцветных ребер в раскраске $C$. Оценим математическое ожидание $X$:
\begin{gather*}
{\sf E}X=\frac{2|E|\binom{m-n}{m/2-n}}{\binom{m}{m/2}}\leqslant \frac{2|E|\binom{m}{m/2}(\frac{m/2}{m})^{n}}{\binom{m}{m/2}}\leq  2c\sqrt{n/\ln n}.
\end{gather*}
Следовательно, с вероятностью не меньше чем $(1-2/x)$ в случайной раскраске гиперграфа  $H=(V,E)$ будет не больше, чем $cx\sqrt{n/\ln n}$ одноцветных ребер.

\bigskip
Следующим шагом в доказательстве теоремы \ref{mntheorem} является применение модифицированной версии Алгоритма перекраски Радакришнана-Сринивасана. Алгоритм Радакришнана-Сринивасана описан в \cite{RadhSrin}, а наша модификация состоит в том, что вместо того, чтобы красить вершины случайно и независимо в 2 цвета, мы случайно делим множество вершин пополам и одну половину вершин красим в один цвет, а другую --- в противоположный. Целью нашего Алгоритма перекраски является построение из раскраски $C$ правильной раскраски в два цвета.

\subsection{Алгоритм построения правильной раскраски из случайной раскраски $C$}
Наша цель --- построить из случайной раскраски $C$ некоторую новую случайную раскраску  и показать, что она является правильной с положительной вероятностью. Для построения подобной раскраски зададим случайный порядок на множестве вершин гиперграфа $V$ c помощью отображения $\sigma:V \to [0,1]$, где $\sigma(v),v\in V$ --- независимые случайные величины с равномерным распределением на $[0,1]$. Также определим отображение $b:V\to\{0,1\}$, где $b(v),v\in V$, --- независимые бернуллиевские случайные величины с параметром $p=(1/2)\ln n/n$.

\bigskip
 Предположим, что нам не повезло и в изначальной случайной раскраске $C$ есть одноцветные ребра. Пусть $v_{1},v_{2},...,v_{m}$ --- вершины гиперграфа, заданные в порядке $\sigma$, т.е. $\sigma(v_{1})\leq\sigma(v_{2})\leq ...\leq\sigma(v_{m})$. Положим $\chi_{0}=C$. Обозначим через $\mathcal{M}(v_{k},\chi_{0})$ число инцидентных $v_{k}$ вершине одноцветных ребер в раскраске $\chi_{0}$. Для исправления ситуации мы используем следующий Алгоритм перекраски:

	1. Если $\mathcal{M}(v_{1},\chi_{0})\neq 0$ и  $b(v_{1})=1$, перекрашиваем вершину $v_{1}$, получая раскраску $\chi_{1}$.
	
    \bigskip
	2. Если хотя бы одно ребро из $\mathcal{M}(v_{2},\chi_{0})$ продолжает быть одноцветным в раскраске $\chi_{1}$ и $b(v_{2})=1$, перекрашиваем вершину $v_{2}$, получая раскраску $\chi_{2}$.
	
	\bigskip
	i. Если хотя бы одно ребро из $\mathcal{M}(v_{i},\chi_{0})$
	продолжает быть одноцветным в раскраске $\chi_{i-1}$ и $b(v_{i})=1$, перекрашиваем вершину $v_{i}$, получая раскраску $\chi_{i}$.
	
	\bigskip
Обозначим финальную раскраску через $\chi^{*}$, а множество одноцветных ребер в раскраске $\chi^{*}$ через $\mathcal{M}(\chi^{*})$.

\subsection{Анализ ситуаций, в которых не получается правильная раскраска}

Пусть $f$ --- произвольное ребро гиперграфа $H$. Оценим вероятность того, что ребро $f$ стало одноцветным в финальной раскраске $\chi^{*}$.
Возможны две ситуации, когда ребро $f$ стало одноцветным в $\chi^{*}$.
\begin{enumerate}
	\item{} Ребро $f$ было одноцветным в $\chi_{0}$ и осталось одноцветным того же цвета в $\chi^{*}$. Обозначим данное событие через $\mathcal{A}(f)$. Заметим, что в этом случае для каждой вершины ребра $f$ выполнено $b(v_{i})=0$. Отсюда,
	$$\Prob(\mathcal{A}(f))\leq\frac{2\binom{m-n}{m/2-n}}{\binom{m}{m/2}}(1-p)^n\leq\frac{2\binom{m}{m/2}\left(\frac{m/2}{m}\right)^n}{\binom{m}{m/2}}(1-p)^n\leq 2^{-n+1}(1-p)^{n}$$
	\item{} Ребро $f$ не было одноцветным в $\chi_{0}$, но стало одноцветным в $\chi^{*}$. Предположим, что в ребре $f$ перекрашена $l+1$ вершина. Рассмотрим вершину $v^{*}$, которая была перекрашена в $f$ последней. В силу Алгоритма перекраски для $v^{*}$ существовало инцидентное одноцветное в раскраске  $\chi_{0}$ ребро $f'$, в котором номер $\sigma(v^{*})$ меньше номеров всех остальных вершин $z$ из $f'$, для которых $b(z)=1$. Нетрудно заметить, что для такого ребра $f'$ будет верно, что $|f\cap f'|=1$.
	
	Обозначим множество оставшихся перекрашенных вершин ребра $f$ за $S$, $v^{*}\notin S$. Заметим, что для каждой вершины $w\in S$ выполнено, что $b(w)=1$ и $\sigma(w)<\sigma(v^{*})$.
	
	Обозначим через $\mathcal{B}(f,f',S)$ событие, заключающееся в том, что два конкретных ребра $f$ и $f'$ и множество вершин $S, S\subset f$, обладают соотвествующими, вышеперечисленными свойствами. Еще нам понадобиться событие $\mathcal{B}(f,f')$, отличающееся от $\mathcal{B}(f,f',S)$ тем, что множество $S$ заранее не фиксировано.
\end{enumerate}
    \begin{gather*}
	\Prob(\mathcal{B}(f,f',S)|\sigma(v^{*})=x)\leq\frac{2\binom{m-2n+1}{m/2-(n-l-1)}}{\binom{m}{m/2}}p^{l+1}x^{l}(1-xp)^{n-1}\leq
	\end{gather*}
	\begin{gather}
	\leq2\cdot 2^{-2n+2}p^{l+1}x^{l}(1-xp)^{n-1},
	\end{gather}
	\begin{gather*}
	\Prob(\mathcal{B}(f,f'))\leq 2^{-2n+3}\sum_{l=0}^{n-1}\binom{n-1}{l}p^{l+1}\int_{0}^{1}x^{l}(1-xp)^{n-1}dx\leq 2\cdot 2^{-2n+2}p.
	\end{gather*}
	
	Второе неравенство в (2.1)\label{4} вытекает из следующих оценок комбинаторных  функций:
	
	$$\frac{2^{2p}}{\sqrt{\pi p}}e^{-1/(4p)}<\binom{2p}{p}<\frac{2^{2p}}{\sqrt{\pi p}},$$
	\begin{gather}
	\frac{\binom{m-2n+1}{m/2-(n-l-1)}}{\binom{m}{m/2}}\leq \frac{2\binom{m-2n}{m/2-n}}{\binom{m}{m/2}}\leq 2^{-2n+1}e^{1/(2m-2n)}\sqrt{\frac{1}{1-2n/m}}\leq 2^{-2n+1}\cdot 2,
	\end{gather}
	 при $n>5$ и $m>n(n-1)/\ln n$, причем, в (2.2) при достаточно большом $n$  множитель $2$ можно заменить на $(1+\epsilon(n))$, где $\epsilon(n)$ сколь угодно мало.

В итоге,
\begin{gather*}
\Prob(\mathcal{M}(\chi^{*})\neq\emptyset)\leq 2\cdot 2^{-n}|E|(1-p)^{n}+2\cdot 2\cdot 2^{-2n+1}|E|^{2}p\leq \\
\\ \leq 2c\sqrt{n/\ln n}\cdot\left(1-\frac{\ln n}{2n}\right)^n+8c^2n/\ln n\cdot\frac{\ln n}{2n}\leq\frac{2c}{\sqrt{\ln n}}+4c^2.
\end{gather*}


А при достаточно большом $n$,
\begin{gather}
\Prob(\mathcal{M}(\chi^{*})\neq\emptyset)\leq 2\cdot 2^{-n}|E|(1-p)^{n}+4(1+\epsilon(n))2^{-2n}|E|^{2}p\leq 2c^2(1+\epsilon(n)).
\end{gather}

\subsection{Построение справедливой раскраски $C^{*}$ из правильной раскраски $\chi^{*}$ }

Обозначим через $M^{i}(\chi^{*})$, $i=1,2$, множество вершин, перекрашенных в цвет ${i}$  в результате Алгоритма перекраски.

Обозначим через $D^{i}(C,j)$, $i=1,2$, $j\geq 1$, множество ребер  $E$, каждое из которых имеет ровно $j$ неперекрашенных вершин цвета ${i}$ в финальной раскраске $\chi^{*}$.
	\begin{equation*}
	D^{1}(C,j)=
	\begin{cases}
	&\text{$e: e\in E(H)$}:\\
	&\text{$(e\setminus (M^{2}(\chi^{*}))\cap K_{1}(C)=j$, }
	\end{cases}
	\end{equation*}
	\begin{equation*}
	D^{2}(C,j)=
	\begin{cases}
	&\text{$e: e\in E(H)$}:\\
	&\text{$(e\setminus (M^{1}(\chi^{*}))\cap K_{2}(C)=j$.}
	\end{cases}
	\end{equation*}

\begin{lemma}\label{lemma2}
Пусть $H=(V,E)$ $n$-однородный гиперграф c $|E|\leqslant c\sqrt{n/\ln n}2^{n}.$ Тогда с вероятностью не меньше, чем $(1-2c(6\cdot e^2-2)/\alpha-2c(e-1)/\alpha\sqrt{\ln n})$, в случайной раскраске $C$ выполнено:
 \begin{equation*}
|D^{i}(C,j)|<\alpha n^{j+1/2}
 \end{equation*}
 для всех $1\leq j\leq\lfloor cx\sqrt{n/\ln n} \rfloor$ и $i=1,2$.
\end{lemma}

\begin{proof}

Пусть в ребре $e$ ровно $k$ вершин, перекрашенных в цвет \\$i ({\rm mod}\; 2)+1$. Обозначим через $D^{i}(C,j,k)$, $i=1,2$, $j\geq 1$, $k\geq 0$, множество ребер  $D^{i}(C,j)$, в которых в финальной раскраске $\chi^{*}$ ровно $k$  вершин перекрашенных в цвет $i ({\rm mod}\; 2)+1$.

\emph{Случай 1: $k=0$.}
Тогда,
\begin{gather*}
\Prob(e\in D^{i}(C,j,0))\leq\binom{n}{j}\frac{\binom{m-n}{m/2-j}}{\binom{m}{m/2}},
\end{gather*}
\begin{gather*}
{\sf E}|D^{i}(C,j,0)|\leq|E|\cdot\binom{n}{j}\frac{\binom{m-n}{m/2-j}}{\binom{m}{m/2}}\leq |E|\cdot \frac{n^j}{j!}\frac{\binom{m-n}{m/2-(n/2)}}{\binom{m}{m/2}}\leq \\
\leq |E|\cdot\frac{2^{-n}n^{j}}{j!}\leq c\frac{n^{j+1/2}}{\sqrt{\ln n}j!},
\end{gather*}
\begin{gather*}
\Prob(\exists j\leq\lfloor cx\sqrt{n/\ln n}\rfloor:|D^{i}(C,j,0))|\geqslant \alpha n^{j+1/2} )\leqslant\\ 1/\alpha\sum_{1\leq j\leq\lfloor cx\sqrt{n/\ln n}\rfloor}\frac{c}{\sqrt{\ln n}j!}\leq\frac{c(e-1)}{\alpha\sqrt{\ln n}}.
\end{gather*}
	
\bigskip
\emph{Случай 2: $k\ge 1$.}

Рассмотрим вершину, которая была перекрашена в ребре $e$ последней. Согласно Алгоритму для этой вершины $v^{*}$ выполнено следующее условие:
	 $\exists f\in E:|f\cap e|\leq (j+1), v\in (f\cap e)$, $f$ одноцветно в изначальной раскраске $C$.
	
Таким образом, событие $\{e\in D^{i}(C,j,k)\}$ подразумевает, что кроме  $v^{*}$ в ребре $e$ было ровно $j+k-1$ вершин цвета ${i}$, а вершина $v$ принадлежала пересечению одноцветного, цвета ${i}$, ребра $f$ с $e$. Всего же вершин во вместе взятых ребрах $f$ и $e$ не меньше, чем $(2n-j-1)$. Отсюда,
	\begin{gather*}
	p(k,e)=\Prob(\text{$e\in D^{i}(C,j,k),\text{ в $e$ перекрашено $k$ вершин})$}\leqslant \\
	\leq|E|\binom{j+1}{1}\left(\binom{n}{j+k-1}\binom{j+k-1}{k-1}p^{k}\right)\frac{\binom{m-(2n-j-1)}{m/2-(n-j-k)}}{\binom{m}{m/2}}.
	\end{gather*}
	Поскольку, $\frac{\binom{m-(2n-j-1)}{m/2-(n-j-k)}}{\binom{m}{m/2}}\leq\frac{\binom{m-2n+j+1}{m/2-n+j+1}}{\binom{m}{m/2}}\leq \frac{2^{j+1}\binom{m-2n}{m/2-n}}{\binom{m}{m/2}}\leq 2\cdot 2^{-2n+j+1}$ (cм. (4)), вероятность события $\{e\in D^{i}(C,j)\}$ может быть оценена следующим образом:
	\begin{gather*}
	\Prob(\text{$e\in D^{i}(C,j)$})=\sum_{k\geq 1} p(k,e)<4|E|(j+1)\left(\sum_{k} \frac{n!}{(n-(j+k-1))!(k-1)!j!}p^{k}\right)2^{-2n+j},
	\end{gather*}
	\begin{gather*}
	{\sf E} |D^{i}(C,j)|\leq|E|\cdot\max_{e}\Prob(\text{$e\in D^{i}(C,j)$})<c\cdot (n/\ln n)\frac{(j+1)2^{j+2}n^{j-1}}{j!}\sum_{k\geq 1}\frac{(np)^{k}}{(k-1)!}=\\
	=cn\cdot\frac{(j+1)2^{j+1}n^{j-1}}{j!}\sum_{k\geq 0}\frac{(np)^{k}}{k!}
	\leq cn^{j}\cdot\frac{2^{j+1}(j+1)e^{1/2\ln n}}{j!}<c\cdot n^{j+1/2}\cdot\frac{2^{j+1}(j+1)}{j!}
	\end{gather*}
	\begin{gather*}
	\Prob(\exists j\leq\lfloor cx\sqrt{n/\ln n}\rfloor:|D^{i}(C,j))|\geqslant \alpha n^{j+1/2})\leqslant \\
	\leq\sum_{1\leq j\leq\lfloor cx\sqrt{n/\ln n}\rfloor}\Prob\left(D^{i}(C,j)\geqslant \frac{\alpha\cdot j!}{c\cdot 2^{j+1}(j+1)}\cdot\mathrm{E} D^{i}(C,j)\right)\leq\\ \leq(c/\alpha)\sum_{j\geq 1}\frac{2^{j+1}(j+1)}{j!}\leq\frac{c(6e^2-2)}{\alpha}.
\end{gather*}
\end{proof}
Теперь мы хотим показать, что найдется подмножество неперекрашенных вершин цвета $i$, перекрасив вершины которого мы не получим одноцветных ребер.

\bigskip
Напомним, что мы обозначили через $D^{i}(C,j)$, $i=1,2$, $j\geq 1$, множество ребер гиперграфа $H$, каждое из которых имеет ровно $j$ неперекрашенных вершин цвета ${i}$ в финальной раскраске $\chi^{*}$.
Для всякого ребра $e$ из $D^{i}(C,j)$ определим  множество $A^{i}(C,j,e)$, состоящее из $j$ неперекрашенных вершин ребра $e$, которые имеют цвет ${i}$ в финальной раскраске $\chi^{*}.$

\begin{lemma}
Во множестве неперекрашенных вершин цвета $i$ существует множество $T'$, такое что:
\begin{enumerate}
	\item [(1.)] $|T'|=\lfloor cx\sqrt{n/\ln n}\rfloor$,
	\item [(2.)] для любого $j\in\{1,2,...,\lfloor cx\sqrt{n/\ln n}\rfloor\}$ и всякого $e\in D^{i}(C,j)$
	выполнено, что
	
	$ A^{i}(C,j,e)\not\subset T'$.
\end{enumerate}
\end{lemma}

\begin{proof}
	Мы доказали, что с вероятностью не меньше, чем $(1-2/x)$ в случайной раскраске гиперграфа $H=(V,E)$ будет не больше, чем $cx\sqrt{n/\ln n}$ одноцветных ребер. Поскольку перекрашенных вершин не больше, чем было изначально одноцветных ребер, число неперекрашенных вершин цвета $i$ не меньше, чем $m/2-cx\sqrt{n/\ln n}$. Для удобства вычислений исключим из множества неперекрашенных вершин те вершины, которые попали в $D^{i}(C,1)$. По лемме \ref{lemma2} с некоторой положительной вероятностью $|D^{i}(C,j)|<\alpha n^{j+1/2}$ для любого $j\in\{1,2,...,\lfloor cx\sqrt{n/\ln n}\rfloor\}.$ Поэтому далее считаем, что мы выбираем множество $T'$ из такого множества, в котором хотя бы $(m/2-cx\sqrt{n/\ln n}-\alpha n^{1+1/2})$ вершин.
	
 Выберем множество $|T'|$ случайно. Тогда,
\begin{gather*}
\Prob(\text{$\exists  j\in\{2,...,\lfloor cx\sqrt{n/\ln n}\rfloor\},\exists e\in D^{i}(C,j):A^{i}(C,j,e)\subset T'$})\leqslant \\
\leq\sum_{2\leq j<\lfloor cx\sqrt{n/\ln n}\rfloor}\alpha n^{j+1/2}\frac{\binom{m/2-\alpha n^{3/2}-cx\sqrt{n/\ln n}-j}{|T'|-j}}{\binom{m/2-\alpha n^{3/2}-cx\sqrt{n/\ln n}}{|T'|}}
\leq\\
\leq\sum_{2\leq j<\lfloor cx\sqrt{n/\ln n}\rfloor}\alpha n^{j+1/2}\left(\frac{|T'|}{m/2}\right)^{j}
\leq\sum_{2\leq j<\lfloor cx\sqrt{n/\ln n}\rfloor}\alpha n^{j+1/2}\left(\frac{ cx\sqrt{n/\ln n}}{n(n-1)/(2\ln n)}\right)^{j}=\\
=\sum_{2\leq j<\lfloor cx\sqrt{n/\ln n}\rfloor}\alpha n^{1/2}\left(\frac{2cx\sqrt{\ln n}}{\sqrt{n}}\right)^j\leq\frac{\alpha (2cx)^2\ln n}{\sqrt{n}(\sqrt{n}-2cx\sqrt{\ln n})}.
\end{gather*}
\end{proof}

\subsection{Завершение доказательства Теоремы \ref{mntheorem}}

Окончательно положим $c=0.01$, $\alpha=8$, $x=5$. Тогда,
\begin{gather}
1-\left(\frac{2}{x}+\frac{2c}{\sqrt{\ln n}}+4c^2+\frac{2c(6\cdot e^2-2)}{\alpha}+\frac{2c(e-1)}{\alpha\ln n}+\frac{\alpha (2cx)^2\ln n}{\sqrt{n}(\sqrt{n}-2cx\sqrt{\ln n})}\right)>0
\end{gather}

Следовательно, с положительной вероятностью
для гиперграфа из условия теоремы \ref{mntheorem}  одновременно выполнены следующие события: в случайной раскраске $C$ мало одноцветных ребер, модифицированный Алгоритм из раскраски $C$ построил правильную раскраску $\chi^{*}$, существует множество, перекраска которого, с одной стороны, уровняет мощности обоих цветовых классов, а с другой стороны, не создаст новых одноцветных ребер. Теорема \ref{mntheorem} доказана.

\begin{corollary}\label{cor}
	При достаточно большом $n$ всякий $n$-однородный гиперграф с числом ребер, не превосходящем $0.7\sqrt{n/\ln n}2^{n}$, допускает справедливую раскраску в два цветa
\end{corollary}

\begin{proof} Пусть $H=(V,E)$ --- гиперграф из условия следствия \ref{cor}.
При достаточно большом $n$ достаточно в (2.4) положить $c=0.7, \alpha=x=10000$ и заменить $4c^2$ оценкой из (2.3) для того чтобы показать, что $H$ можно справедливо раскрасить в два цвета.
\end{proof}
		
	
		\newpage
	\section{Доказательство Теоремы \ref{mntheorem2}}
	
	\subsection{Построение справедливой раскраски: Алгоритмы перекраски}
	
	Пусть $H=(V,E)$ --- гиперграф из условия теоремы \ref{mntheorem2}. Для удобства будем считать, что число вершин $m$ кратно $r$. Под  сбалансированной раскраской $C=C(K_{1},K_{2},...,K_{r})$ будем понимать некоторое разбиение множества вершин гиперграфа на $r$ равных долей: $V=K_{1}\sqcup K_{2}...\sqcup K_{r}, |K_{1}|=|K_{2}|=...=|K_{r}|$.
	
	\begin{lemma}\label{lemma1}
		Пусть $H=(V,E)$ произвольный $n$-однородный гиперграф, в котором выполнены следующие соотношения:
		\begin{equation*}
		|E|<c\left(\frac{n}{\ln(n)}\right)^{\lfloor \log_{2}(r)/\log_{2}(r)+1\rfloor} r^{n-1},~~~~~~|V|<\frac{n(n-1)(r-1)\lfloor\frac{log_{2}(r)+1}{\log_{2}(r)}\rfloor}{2\ln(n)}.
		\end{equation*}
		Тогда при $c<1$  для $H$ существует справедливая раскраска в $r$ цветов.
	\end{lemma}
	
	
	\begin{proof} Рассмотрим случайную сбалансированную раскраску $C$ гиперграфа $H$. 
		
		Тогда,
		\begin{gather*}
		\Prob(\text{есть одноцветное ребро в $C$})\leq\sum_{e\in E}\frac{r\binom{m-n}{m/r-n}\cdot\binom{m-m/r}{m/r}\cdot...\cdot\binom{m/r}{m/r}}{\binom{m}{m/r}\cdot\binom{m-m/r}{m/r}\cdot...\cdot\binom{m/r}{m/r}}=|E|\frac{r\binom{m-n}{m/r-n}}{\binom{m}{m/r}}=\\
		\\=|E|\frac{r^{-n+1}(1-r/m)...(1-r(n-1)/m)}{(1-1/m)...(1-(n-1)/m)}\leq\\ 
		\leq c\left(\frac{n}{\ln(n)}\right)^{\frac{\lfloor\log_{2}(r)}{\log_{2}(r)+1}\rfloor}\frac{\exp(\ln(1-r/m)+...+\ln(1-r(n-1)/m))}{\exp(\ln(1-1/m)+...+\ln(1-(n-1)/m))}=\\
		= c\left(\frac{n}{\ln(n)}\right)^{\lfloor\frac{log_{2}(r)}{\log_{2}(r)+1}\rfloor}\prod_{x=1}^{n-1}\exp\left(\ln(1-rx/m)-\ln(1-x/m)\right)
		\end{gather*}
		
		Из разложения натурального логарифма в ряд Тейлора следует, что $\ln(1-rx/m)-\ln(1-x/m)<-x(r-1)/m$ при $x\in(0;1)$. Поэтому, складывая показатели степеней у произведения экспонент, окончательно получаем:
		
		\begin{gather*}
		\Prob(\text{есть одноцветное ребро в $C$})\leq c\left(\frac{n}{\ln(n)}\right)^{\lfloor\frac{log_{2}(r)}{\log_{2}(r)+1}\rfloor}e^{-n(n-1)(r-1)/2m}\leq \frac{c}{n^{\log_{2}(r)/\log_{2}(r)+1}}<1
		\end{gather*}
		
		Cледовательно, с положительной вероятностью случайная сбалансированная раскраска $C$ является справедливой раскраской. \hyperref[lemma1]{Лемма 1} доказана.
	\end{proof}
	
	Таким образом, нам остается рассмотреть гиперграфы, в которых число вершин $m$ больше, чем $n(n-1)(r-1)\lfloor\frac{log_{2}(r)+1}{\log_{2}(r)}\rfloor/2\ln(n)$. 
	
	\subsubsection{Алгоритм 1: построение правильной раскраски}
	
	Следующим шагом в доказательстве Теоремы \ref{mntheorem2} является применение модифицированной версии Алгоритма перекраски А. Косточки. Алгоритм А. Косточки описан в \cite{Kost}, а наша модификация состоит в том, что, значение случайной величины, которая отвечает за то, что вершина из одноцветного ребра будет перекрашена,  фиксируется вначале и не меняется в процессе работы Алгоритма.
	
	\bigskip
	Наша цель --- построить из случайной раскраски $C^{0}$ некоторую новую случайную раскраску  и показать, что она является правильной с положительной вероятностью. Для построения подобной раскраски зададим случайный порядок на множестве вершин гиперграфа $V$ c помощью отображения $\sigma:V \to [0,1]$, где $\sigma(v),v\in V$ --- независимые случайные величины с равномерным распределением на $[0,1]$. Если $\sigma(v)<p$, где $p$ --- некоторый параметр нашей конструкции, то вершину $v$ будем называть свободной. Пусть $x=\lfloor\log_{2}r\rfloor$.
	
	\bigskip
	Предположим, что в раскраске $C^{0}$ есть одноцветные ребра. Для исправления ситуации мы используем следующий Алгоритм перекраски:\label{formula}
	
	\bigskip
	Этап $l,0< l\leq  x.$ 
	Для каждой вершины $v$ проверяем выполнимость двух условий:
	
	\begin{enumerate}
		\item она никогда не меняла свой цвет и является свободной, \label{1}
		\item в текущий раскраске имеется инцидентное $v$ одноцветное ребро $A, v\in A$ некоторого цвета $\alpha\in\{1,\ldots,r\}$ , и никакая из его вершин не была перекрашена на этапе $l$.\label{2}
	\end{enumerate}
	
	Если выполнены оба условия, перекрашиваем  вершину $v$ в цвет $(\alpha+2^{l-1})({\rm mod}\; r)$. В этом случае будем говорить, что перекрашенная вершина $v$ обвиняет ребро $A$. 
	
	Если какое-то из условий \ref{1}.-\ref{2}. не выполняется, то переходим к следующей вершине. Если мы перебрали все вершины, то переходим на этап $(l+1)$.
	
	\bigskip
	Отметим, что в рамках процедуры перекраски каждая вершина меняет цвет не более одного раза, поэтому Алгоритм не может работать бесконечно и обязательно остановится. 
	
	\subsubsection{Алгоритм 2: восстановления равенства мощностей цветовых классов}
	
	\bigskip
	Мощности цветовых классов могут отличаться от $m/r$. Определим для каждого цветового класса $K_{i}$ неотрицательные целые числа $ex_{i}$ и $sh_{i}$, где $ex_{i}$ --- величина избытка, т.е. на сколько вершин цвета $r_{i}$ больше чем $m/r$, аналогично для недостатка. Ясно что, если $ex_{i}>0$, то $sh_{i}=0$, и наоборот.
	
	Выберем случайно в каждом цветовом классе $K_{i}$ подмножество вершин $V_{i}$, размера $q$. Значение параметра $q$ определим позже. А пока предположим, что $q>2ex_{i}$ для любого $i$.
	
	\bigskip
	\begin{algorithm}[H]\label{formula2}
		
		\KwData{набор чисел $ex_{i}$ и $sh_{i}, i=1,2,...,r.$}
		\For{$(i=1;i<r;i++)$}{
			\If{$(sh_{i}!=0)$}{
				\{берем минимальное $t: ex_{1}+ex_{2}+...+ex_{t}\geq sh_{i}$ 	\;
				В каждом множестве $V_{s}, s<t$ перекрашиваем в цвет $i$ первые $ex_{s}$ вершин. А в последнем множестве $V_{t}$ перекрашиваем в цвет $i$ первые $sh_{t}-(ex_{1}+ex_{2}+...+ex_{t-1})$ вершин.  	
				
			}
			{$ex_{1}=0,ex_{2}=0,...,ex_{t}=ex_{t}-(sh_{t}-(ex_{1}+ex_{2}+...+ex_{t-1})).$\}
				
			}
		}
	\end{algorithm}
	
	\bigskip
	\textbf{Комментарии:} 
	
	\begin{itemize}
		
		\item Шаг $1$. Пусть цвет $i$ --- это первый цвет, который в недостатке.
		Берем минимальное $t: ex_{1}+ex_{2}+...+ex_{t}\geq sh_{i}.$
		В каждом множестве $V_{s}, s<t$ перекрашиваем в цвет $i$ первые $ex_{s}$ вершин. А в последнем множестве $V_{t}$ перекрашиваем в цвет $i$  первые $sh_{t}-(ex_{1}+ex_{2}+...+ex_{t-1})$ вершин.  После перекраски мощности цветовых классов  $K_{1},...,K_{t-1},K_{i}$ становятся равными $m/r$. Теперь цвета $1,...,t-1$ больше не нужны и мы кладем $ex_{1}=0,ex_{2}=0,...,ex_{t}=ex_{t}-(sh_{t}-(ex_{1}+ex_{2}+...+ex_{t-1}))$. На этом шаг $1$ заканчивается.
		
		\item Шаг $2$. Берем следующий цвет, который в недостатке. Проделываем тоже самое, что и в шаге $1$. Множества из которых мы теперь набираем вершины отличаются от $V_{1},...,V_{t-1}$, за исключением  множества $V_{t}$. 
	\end{itemize}
	
	Ясно, что \hyperref[formula2]{Алгоритм 2} сделает все цветовые классы равные $m/r$. Если при этом, мы сможем выбирать вершины для перекраски таким образом, чтобы не появлялись новые одноцветные ребра, то мы получим справедливую раскраску.
	
	\subsection{$T$-деревья}
	
	Обозначим через $C^{1}$ раскраску, которая получилась после работы \hyperref[formula]{Алгоритма 1}, а через $C^{2}$ --- финальную раскраску, т.е. раскраску после работы \hyperref[formula2]{Алгоритма 2}. Нас интересует количество одноцветных ребер, которые получились в раскрасках $C^{1}$ и $C^{2}$. 
	
	\bigskip
	Начнем с одноцветных ребер в раскраске $C^{1}$. Обозначим через $A$ одно из подобных одноцветных ребер некоторого цвета $\alpha$. Яcно, что в силу Алгоритма перекраски каждая вершина $v$ ребра $A$ в раскраске $C^0$ могла быть только следующих цветов: $\alpha,\alpha-2^0,\alpha -2^2,...,\alpha-2^{k-1}({\rm mod}\; r)$. Предположим, что $\{i^A_{1},i^A_{2},...,i^A_{s}\}$ --- это цвета, которые были у вершин ребра $A$ в  $C^0$. Определим через  $a_{i^A_{1}},a_{i^A_{2}},...,a_{i^A_{s}}$ набор вершин ребра $A$, где каждая вершина $a_{i^A_{k}}$ обладает самым большим весом среди всех  вершин цвета $i^A_{k}$ ребра $A$. Для сокращения записи, будем называть такой набор вершин  доминантным  набором --- $Dominant(A)$ ребра $A$, а вершины набора доминантными.
	
	\bigskip
	Начнем построение конфигурации ребер $H$, которую мы назовем $T$-\emph{деревом} с корнем $A$. 
	
	\begin{itemize}
		\item В качестве корня мы возьмем ребро $A$, а его потомками будут все ребра $B$, которые обвиняют доминантные вершины $a_{i^A_{1}},a_{i^A_{2}},...,a_{i^A_{s}}$ (по одному ребру для каждой вершины).
		\item Далее, в каждом ребре $B$ есть свой набор цветов $\{i^B_{1},i^A_{2},...,i^B_{t}\}$ и соответствующий ему доминантный набор вершин  $b_{i^B_{1}},b_{i^B_{2}},...,b_{i^B_{t}}$, которые были перекрашены до того, как ребро $B$ стало одноцветным. Подобные вершины обязаны обвинять некоторые новые ребра $C$, иначе ребро $B$ не могло бы стать одноцветным и, в свою очередь, никто не смог бы его обвинить. Добавим подобные ребра $C$ в качестве потомков ребра $B$
		\item Продолжим процесс построения, пока будет возможно.
	\end{itemize} 
	
	\bigskip
	В результате мы получим  $T$-дерево, вершинами которого выступают ребра гиперграфа $H$, а связь определяется отношениями обвинения. Листьями получившегося  $T$-дерева будут как раз те ребра гиперграфа $H$, которые являлись одноцветными в исходной сбалансированной случайной раскраске $C^0$. Корнем $T$-дерева является одноцветное ребро в раскраске $C^{1}$. 
	
	\bigskip
	Введем понятие $T$-поддерева с корнем $A$. Для этого рассмотрим вершину $A\in T$. Пусть $N(A)$ множество всех предков $A$ в $T$-дереве. Тогда $A$ вместе с $N(A)$ будем называть \emph{T-поддеревом}. Корнем $T$-поддерева является ребро, которое было одноцветным на некотором этапе работы \hyperref[formula]{Алгоритма 1}. Соответственно, под \emph{высотой} $h(A)$ $T$-поддерева с корнем $A$ будем понимать наибольшую длину пути из корня $A$ в лист.  
	
	\begin{corollary}
		Пусть заданы $\sigma$ и случайная раскраска $C^{0}$. Предположим, что  \hyperref[formula]{Алгоритм 1} не сработал, т.е. не  построил правильную раскраску, тогда появилось хотя бы одно $T$-дерево.
	\end{corollary}
	
	\subsubsection{$T$-сложные деревья}
	
	Вернемся к рассмотрению одноцветных ребер в раскраске $C^{2}$. Зафиксируем некоторый цвет $i$ и рассмотрим все одноцветные ребра цвета $i$ в раскраске $C^{2}$. Каждое такое ребро $A$ может содержать вершины только двух типов: каждая $v\in A$
	
	\begin{itemize}
		\item либо была цвета $i$ уже после завершения работы \hyperref[formula]{Алгоритма 1}.
		\item либо получила цвет $i$ во время работы \hyperref[formula2]{Алгоритма 2}. Обозначим через $U(A)$ множество вершин ребра $A$, имеющих тип $2$.
	\end{itemize}
	
	Рассмотрим вершины $w$, которые имеют цвет $i$ уже после \hyperref[formula]{Алгоритма 1}. Как и в предыдущем случае среди этих вершин $w$ мы можем выбрать доминантный набор вершин $Diominant(A)$, а для этого доминантного набора набор ребер $B_{1},...,B_{s}$, которые обвиняют доминантные вершины.
	
	\bigskip
	Начнем построение конфигурации ребер $H$, которую мы назовем $T$-\emph{сложным деревом}. Зафиксируем ребро $A$ и неупорядоченный набор ребер  $B_{1},...,B_{s}$. Теперь в качестве корня мы возьмем ребро $A$, а его потомками будут все ребра $B_{1},...,B_{s}$. После этого  мы  строим уже обычные $T$--поддеревья: $T(B_{1}),...,T(B_{s})$. На этом процесс построения заканчивается. Обозначим получившееся $T$--сложное дерево через $T(A,B_{1},...,B_{s})$.
	
	\bigskip 
	Рассмотрим теперь в ребре $A$ те вершины $u$, которые получили цвет $i$ во время работы \hyperref[formula2]{Алгоритма 2}. Если $u\in A\cap T(B_{t})$, то изначальный цвет такой вершины уже известен. Поэтому рассмотрим те вершины $u$, которые не попадают в такие пересечения. Согласно \hyperref[formula2]{Алгоритму 2} каждая такая вершина принадлежит некоторому подмножеству $V_{i}$ и  имеет в $C^{0}$ цвет $i$.
	
	\subsubsection{Вспомогательные утверждения о $T$-деревьях}
	
	\begin{lemma}
		$T$-дерево --- это граф без циклов, в котором для любых двух вершин  $x_{1}$ и $x_{2}$
		
		\begin{itemize}
			\item  либо $e(x_{1})\cap e(x_{2})=\emptyset$,
			\item  либо $|e(x_{1})\cap e(x_{2})|=1$ и $x_{1}$, $x_{2}$ смежные вершины $T$-дерева.
		\end{itemize}
		
	\end{lemma}
	
	\begin{proof}
		Докажем сначала, что в графе $T$ нет циклов. Предположим обратное: пусть $f_{1},f_{2},...,f_{k},f_{1}$ --- цикл. Пусть  $f_{1}$ начало цикла и главный цвет ребра $e(f_{1})$ равен $\alpha$. Для того чтобы цикл замкнулся на вершине $f_{1}$ ребро $e(f_{1})$ должно снова стать одноцветным. Посчитаем цвет, который должен получиться у ребра $e(f_{1})$: обозначим через $h(v)$ высоту поддерева с корнем $v$, тогда главные цвета ребер $f_{1},f_{2},...,f_{k}, f_{k+1}=f_{1}$ будут равны соответственно  $\alpha, (\alpha+2^{h(f_{2})-1})({\rm mod}\; r),..., (\alpha+2^{h(f_{2})-1}+...+2^{h(f_{k+1})-1})({\rm mod}\; r)$.
		
		C  другой стороны, в ребре $e(f_{1})$ есть перекрашенная вершина, которая согласно \hyperref[formula]{Алгоритму 1} не может уже поменять свой цвет ---  $(\alpha+2^{h(f_{2})-1})({\rm mod}\; r) $. Числа $(\alpha+2^{h(f_{2})-1})({\rm mod}\; r)$ и $(\alpha+2^{h(f_{2})-1}+...+2^{h(f_{k+1})-1})({\rm mod}\; r)=(\alpha+2^{h(f_{2})-1}\cdot(2^{k+1}-1))({\rm mod}\; r)$ не могут совпасть, поскольку тогда должно быть выполнено следующее сравнение по модулю $r$:
		\begin{gather*}
		2^{h(f_{2})-1} \equiv 2^{h(f_{2})-1}\cdot(2^{k+1}-1) \pmod r\\
		2^{h(f_{2})} \equiv 2^{h(f_{2})+k}\pmod r
		\end{gather*}
		Последнее не может быть выполнено, поскольку 
		$h(f_{2})+k<\lfloor\log_{2}r\rfloor$. В итоге мы получили противоречие, что $f_{1},f_{2},...,f_{k},f_{1}$ цикл.
		
		Докажем второе утверждение. Пусть сначала $x_{1}$ и $x_{2}$ смежные вершины. Тогда если в пересечение  $e(x_{1})\cap e(x_{2})$ больше одной вершины, то получается, что в $C^{0}$ есть две доминантные вершины одного цвета, чего не может быть. Пусть теперь $|e(x_{1})\cap e(x_{2})|\geq 1$ для двух несмежных вершин. Тогда, есть два ребра $f_{i}$ и $f_{j}$ (мы допускаем возможность, что  $f_{i}=f_{j}$), у которых совпадают главные цвета. Пусть их главный цвет равен $\beta$. Рассмотрим два пути:
		
		\begin{gather*}
		P_{1}=(C_{0}=root,C_{1},...,C_{t}=f_{i},...,C_{k})\\
		P_{2}=(C_{0}=root,\tilde{C_{1}},...,\tilde{C_{s}}=f_{i},...,\tilde{C_{l}}),
		\end{gather*}
		
		где $C_{k}$ и $\tilde{C_{l}}$ --- листья. Согласно \hyperref[formula]{Алгоритму 1}, главный цвет ребра $e(C_{0})$ равен $(\beta+2^{k-t}+2^{k-t+1}+...2^{k-1})({\rm mod}\; r)=(\beta+2^{k-t}\cdot(2^t-1))({\rm mod}\; r)$ и $(\beta+2^{l-s}+2^{l-s+1}+...+2^{l-1})({\rm mod}\; r)=(\beta+2^{l-s}\cdot(2^s-1))({\rm mod}\; r)$ одновременно. Ввиду того, что числа $2^t-1$ и $2^s-1$ нечетные при $s,t>1$, сравнение выполнено только при $s=t$ и $l=k$. Но это противоречит \hyperref[formula]{Алгоритму 1}, так как у корня $T$-дерева будут две доминантные вершины одного цвета.
	\end{proof}
	
	\begin{corollary}
		Если в $T$-дереве известен итоговый цвет $\alpha$ корня $A$, то изначальные цвета всех доминантных вершин гиперграфа $H$, входящих в $T$-дерево, однозначно определяются по структуре графа $T$.	
	\end{corollary}
	
	\begin{lemma}
		Из ребер гиперграфа $H$ можно составить не более, чем $m\cdot\binom{|E|}{m}$ $T$--деревьев размера $m$.
	\end{lemma}
	
	\begin{proof}
		Возьмем произвольный неупорядоченный набор из $m$ ребер гиперграфа $H$. Выберем среди одно ребро, которое будет соответствовать корню $A$. Обозначим его через $A$. 
		Среди оставшихся ребер рассмотрим все такие ребра --- $B_{1},...,B_{s}$, которые пересекаются с ребром $A$. Добавим их в качестве предков  $A$. Далее, среди оставшихся ребер ищем те, которые смежны с ребрами $B_{1},...,B_{s}$, они будут потомками вершин $B_{1},...,B_{s}$. Продолжая действовать  таким образом мы в итоге получим граф $G$. Если он удовлетворяет условию леммы 1 и в нем $m$ вершин, то мы построили $T$-дерево, иначе делаем вывод, что из данного набора ребер нельзя составить $T$-дерево. Таким образом, число $T$-деревьев не превосходит $m\cdot\binom{|E|}{m}$.
	\end{proof}
	
	\begin{lemma}
		Из ребер гиперграфа $H$ можно составить не более, чем $\binom{|E|}{m}m2^{m-1}$ $T$-сложных деревьев размера $m$.
	\end{lemma}
	
	\begin{proof}
		Зафиксируем число $s$ --- число предков первого порядка у вершины $A$. Возьмем произвольный неупорядоченный набор из $m$ ребер гиперграфа $H$. Выберем среди них ребро, которое будет соответствовать корню $A$, среди оставшихся ребер выберем ребра, которые будут соответствовать предкам $B_{1},...,B_{s}$. Это можно сделать не более, чем $m\binom{m-1}{s}$ способами. Далее, для каждого $T$-поддерева $T(B_{k}), k=1,2,...,s$ будем набирать ребра так как мы делали в лемме 3. Таким образом, общее число $T$-сложных деревьев не превосходит $\binom{|E|}{m}m\sum_{s=0}\binom{m-1}{s}$.
	\end{proof}
	
	\subsection{Оценка числа одноцветных ребер, образовавшихся после работы \hyperref[formula]{Алгоритма 1}} 
	
	Во всех дальнейших вычислениях мы будем предполагать, что есть некоторый $n$-однородный гиперграф $H$, в котором $|E|\leq c\left(\frac{n}{\ln n}\right)^{\lfloor \log_{2}(r)/\log_{2}(r)+1\rfloor} r^{n-1}$, a число цветов $r\leq\sqrt{\frac{\ln n}{\tilde{c}(\ln \ln n)^3}}$.
	
	\begin{lemma}\label{lemma5}
		Пусть $\sigma$ и $C^{0}$ заданы случайно, тогда с положительной вероятностью \hyperref[formula]{Алгоритм 1} построит правильную раскраску $C^{1}$ в $r$ цветов.
	\end{lemma}
	
	\begin{proof} 
		Рассмотрим событие заключающееся в том, что \hyperref[formula]{Алгоритма 1} не сработал, когда $\sigma$ и $C^{0}$ были заданы случайно. Согласно следствию 1, это событие могло произойти только тогда, когда появилось хотя бы одно $T$-дерево. Мы переберем все возможные $T$-деревья, оценивая для каждого $T$-дерева вероятность события, заключающегося в том, что в результате процесса случайной перекраски нашелся набор ребре гиперграфа $H$, который образовал это $T$-дерево. 
		
		\bigskip
		Итак, пусть мы зафиксировали некоторое $T$-дерево с корнем $A$. Пусть $\alpha$ --- цвет ребра $A$ в раскраске $C^{1}$. Предположим, что доминантный набор вершин ребра $A$ состоит из $s$ вершин, которые обвиняют ребра $B_{1},...,B_{s}$. Согласно следствию 2 изначальные цвета этих $s$ вершин однозначно определяются по структуре графа $T$. Обозначим через $x_{1},...,x_{s}$ соответствующие веса вершин доминантного набора ребра $A$. Теперь, согласно \hyperref[formula]{Алгоритму 1} цвет любой $v\in A: v\notin\mathcal{D(A)}$ 
		
		\begin{itemize}
			\item либо равен $\alpha$
			\item либо равен цвету одной из доминантных вершин $\{a_{i_{j}}^{A}:\sigma(v)\leq \sigma(a_{i_{j}}^{A})\}$
		\end{itemize} 
		
		Рассмотрим теперь ребро $B_{1}$. Пусть у $B_{1}$ ровно $t$ доминантных вершин, а их веса равны $y_{1},...,y_{t}$. Тогда цвет любой $v\in B_{1}: v\notin\mathcal{D}(B_{1})$ равен либо главному цвету ребра $B_{1}$, либо равен цвету одной из доминантных вершин $\{b_{i_{j}}^{B_{1}}:\sigma(v)\leq\sigma(b_{i_{j}}^{B_{1}})\}$.Повторяя рассуждения для всех вершин $T$-дерева, мы ограничим множество цветов, которые могут быть у вершин гиперграфа $H$.
		
		\bigskip
		Тем не менее вероятность появления $T$-дерева сильно зависит от номера этапа $l$ на котором завершилось образование $T$-дерева. Поэтому мы рассмотрим два случая и проведем вычисления для каждого случая отдельно. 
		
		\begin{enumerate}
			\item[\bf 1.] Образовалось дерево за $l<x=\lfloor\log_{2}r\rfloor$ этапов.
			
			Обозначим данное событие через $\mathcal{A}$.
			В этом случае все вершины $v\in A$ цвета $\alpha$ имееют вес больше $p$.
			Пользуясь леммой 3 о числе $T$-деревьев мы можем оценить вероятность событие $\mathcal A$ следующим образом: 
			
			\begin{gather*}
			\Prob(\mathcal A)\leq r\sum_{m=1} m\cdot|E|^{m}\underbrace{\iint...\int}_{[0;p]^{m-1}} \left(\frac{x_{1}}{r}+...\frac{x_{s}}{r}+\frac{1-p}{r}\right)^{n-s}\cdot\\ \cdot\left(\frac{y_{1}}{r}+...\frac{y_{t}}{r}+\frac{1-x_{1}}{r}\right)^{n-t-1}\cdot...\cdot\left(\frac{1}{r}\right) ^{m-1}
			\end{gather*}
			
			Оценим числитель подынтегрального выражения:
			
			\begin{gather*} 
			\left(x_{1}+...x_{s}+1-p\right)^{n-s} \cdot\left(y_{1}+...+y_{t}+1-x_{1}\right)^{n-t-1}\cdot...\cdot\leq
			\\\leq\left[(x_{1}+...x_{s}+1-p)\left(y_{1}+...+y_{t}+1-x_{1}\right)\cdot...\cdot\right]^n\cdot(1-p)^{-s}\cdot(1-p)^{-t-1}\cdot...\cdot\leq
			\\\leq\left(1-\frac{p}{m}\right)^{mn}\cdot(1-p)^{-2(m-1)}
			\end{gather*}
			
			С учетом полученной оценки на числитель,
			
			\begin{gather*} 
			\Prob(\mathcal A)\leq r\sum_{m=1} m\cdot |E|^{m}p^{m-1}\left(\frac{1}{r}\right)^{(n-1)m+1}\left(1-\frac{p}{m}\right)^{mn}\cdot(1-p)^{-2(m-1)}\leq\\
			\leq\sum_{m=1} \left[\left(\frac{2cn}{\ln n}\right)^{\lfloor\frac{ \log_{2}(r)}{log_{2}(r)+1}\rfloor}\right]^{m}p^{m-1}\left(1-\frac{p}{m}\right)^{mn}\cdot(1-p)^{-2(m-1)}\leq\
			\\|\text{ $p=\gamma\frac{\ln n}{n}$}|
			\\
			\leq 2c\sum_{m=1}\left(\frac{n}{\ln n}\right)^{\lfloor\frac{ \log_{2}(r)}{log_{2}(r)+1}\rfloor}\left(\frac{\ln n}{n}\right)^{\frac{m-1}{\log_{2}(r)+1}}\frac{1}{n^{\gamma}}\leq \frac{2cn^{1-\gamma}}{\ln n}\sum_{m=1}\exp\left(-\frac{\ln\frac{n}{\ln n}}{\log_{2}(r)+1}(m-1)\right)
			\end{gather*}
			
			Ряд $\sum_{m=1}\exp(-\alpha m)$ сходится при $\alpha\geq 1$. Таким образом, когда число цветов невелико и $\gamma\geq 1$, вероятность события $\mathcal A$ будет стремится к нулю при $n\rightarrow\infty$, при этом  $\Prob(\mathcal A)$ заведомо меньше, чем $4c$.
			
			\item[\bf 2.] Образовалось дерево на последнем этапе \hyperref[formula]{Алгоритма 1}. $l=x=\lfloor\log_{2}r\rfloor$.
			
			Обозначим данное событие через $\mathcal{B}$. В этом случае мы не можем ничего сказать о  вершинах $v\in A$ цвета $\alpha$. Однако, за счет того, что $T$-дерево построилось в конце, мы можем утверждать, что в нем много вершин, а именно $m\geq\lfloor\log_{2}r\rfloor$.
			
			\begin{gather*}
			\Prob(\mathcal B)\leq r\sum_{m>\lfloor\log_{2}r\rfloor} m\cdot|E|^{m}\underbrace{\iint...\int}_{[0;p]^{m-1}} \left(\frac{x_{1}}{r}+...\frac{x_{s}}{r}+\frac{1}{r}\right)^{n-s}\cdot\\ \cdot\left(\frac{y_{1}}{r}+...\frac{y_{t}}{r}+\frac{1-x_{1}}{r}\right)^{n-t-1}\cdot...\cdot\left(\frac{1}{r}\right) ^{m-1}
			\end{gather*}
			
			С учетом того, что числитель подынтегрального выражения не превосходит 1,
			
			\begin{gather*} 
			\Prob(\mathcal B)\leq r\sum_{m>\lfloor\log_{2}r\rfloor}m\cdot |E|^{m}p^{m-1}\left(\frac{1}{r}\right)^{(n-1)m+1}\leq\\
			\leq\sum_{m>\lfloor\log_{2}r\rfloor} \left[\left(\frac{2cn}{\ln n}\right)^{\lfloor\frac{ \log_{2}(r)}{log_{2}(r)+1}\rfloor}\right]^{m}p^{m-1}\leq
			\\\leq 2c\sum_{m>\lfloor\log_{2}r\rfloor}\left(\frac{n}{\ln n}\right)^{\lfloor\frac{ \log_{2}(r)}{log_{2}(r)+1}\rfloor}\left(\frac{\ln n}{n}\right)^{\frac{m-1}{\log_{2}(r)+1}}\leq 2c\sum_{m=1}\exp\left(-\frac{\ln\frac{\ln n}{n}}{\log_{2}(r)+1}(m-1)\right)<4c
			\end{gather*}
			при ограничении на число цветов.
			
		\end{enumerate}
	\end{proof}
	
	\subsubsection{Оценка на максимальный избыток}
	
	В этом параграфе мы получим явное соотношение на параметр $q$ из \hyperref[formula2]{Алгоритма 2}. Напомним, что мы хотим, чтобы $q\geq 2\max_{i} ex_{i}$. Поэтому следующим действием будет оценка сверху величины $ex_{i}$.
	
	Пусть $\sigma$ и $C^{0}$ заданы случайно. Обозначим через $Rec(\alpha)$ случайную величину равную числу вершин $v$, перекрашенных в цвет $\alpha$ в результате \hyperref[formula]{Алгоритма 1}. 
	Также, для каждого цветового класса $K_{\alpha}$ рассмотрим случайную величину $X_{K_{\alpha}}$ , равную число вершин цвета $\alpha$ в $C^{0}$.  Ясно, что $X_{K_{\alpha}}$ имеет биномиальное распределение $Bin(m,1/r)$.
	
	Таким образом, суммируя вышесказанное, заметим, что для каждого цвета $\alpha$, который в избытке, выполнено, что 
	
	\begin{gather*}
	ex_{\alpha}\leq Rec(\alpha)+\left(X_{K_{\alpha}}-\frac{m}{r}\right). 
	\end{gather*}
	
	Используя неравенство Чернова, которое утверждает, что для случайной величины $X\sim Bin(n,p)$
	
	\begin{gather*}
	\Prob(X > EX + t)\leq\exp\left(-\frac{t^2}{2(EX +t/3)}\right)
	\end{gather*}
	
	с $t =\sqrt{\frac{2m\ln r/c}{r}}$, получаем оценки
	
	\begin{gather*}
	\Prob\left(\exists\alpha:  X_{K_{\alpha}} >\frac{m}{r} + t\right)\leq r\exp\left(-\frac{t^2}{2(\frac{m}{r}+t/3)}\right)<\frac{cr}{r}=c
	\end{gather*}
	
	Получим теперь оценку на величину $Rec(\alpha)$. Для этого заметим, что каждой $v$, перекрашенной в цвет $\alpha$, соответствует некоторое $T$-поддерево --- $T(A)$. Соответствие заключается в том, что вершина $v$ обвиняет ребро $A$. При этом, доминантный цвет ребра $A$ в $T$-поддереве $T(A)$ однозначно определяется по структуре графа $T$. Действительно, чтобы вершина $v$ перекрасилась в цвет $\alpha$ необходимо, чтобы доминантный цвет ребра $A$ был равен в точности $(\alpha-2^{h(A)-1})({\rm mod}\; r)$, где $h(A)$ --- высота дерева $T$. Таким образом, нам остается оценить число $T$-поддеревьев, у которых доминантный цвет корня заранее определен.
	
	По аналогии с уже проделанными вычислениями для $T$-деревьев, математическое ожидание числа  $T$-поддеревьев, а следовательно, и $\sf{E Rec(\alpha)}$ оценивается как 
	
	\begin{gather*}
	\text{\sf{E}} Rec(\alpha)\leq\sum_{m=1} p^{m-1}m\cdot\binom{|E|}{m}\left(\frac{1}{r}\right)^{(n-1)m+1}
	\end{gather*}
	
	Для сокращения записи обозначим через $k$ следующее выражение : $\left(\frac{n}{\ln(n)}\right)^{\lfloor \log_{2}(r)/\log_{2}(r)+1\rfloor}$. Тогда, при $p=\gamma\frac{\ln n}{n}$ и $r<\left(\frac{n}{\ln n}\right)^{\ln 2}$.
	
	\begin{gather*}
	\sum_{m=1} p^{m-1}m\cdot\binom{|E|}{m}\left(\frac{1}{r}\right)^{(n-1)m+1}\leq \frac{2c}{r}\sum_{m=1}\left(\frac{n}{\ln n}\right)^{\lfloor\frac{ \log_{2}(r)}{log_{2}(r)+1}\rfloor}\left(\frac{\ln n}{n}\right)^{\frac{m-1}{\log_{2}(r)+1}}\leq \frac{4ck}{r}
	\end{gather*}
	
	Окончательно получаем, что с положительной вероятностью для каждого цвета $\alpha$ 
	
	\begin{gather*}
	Rec(\alpha)\leq \frac{k}{2}.
	\end{gather*}
	
	Положим параметр $q$ равным 
	
	\begin{gather}
	q=\left(\frac{n}{\ln(n)}\right)^{\lfloor \log_{2}(r)/\log_{2}(r)+1\rfloor}+2\sqrt{\frac{2m\ln r/c}{r}}.
	\end{gather}
	
	Таким образом, с положительной вероятностью 
	\begin{gather}
	max_{i} ex_{i}\leq q/2.
	\end{gather}
	
	А повторяя предыдущие рассуждения для $sh_{i}$, можно получить, что с положительной вероятностью 
	\begin{gather}\label{sh_i}
	max_{i} sh_{i}\leq q/2.
	\end{gather}
	
	\subsection{Оценка числа одноцветных ребер, образовавшихся после работы \hyperref[formula2]{Алгоритма 2}}
	
	В предыдущей главе мы доказали, что с большой вероятностью  после завершения работы \hyperref[formula]{Алгоритма 1} все ребра гиперграфа $H$ будут неодноцветными. Поэтому предположим, что все одноцветные ребра, которые мы имеем в финальной раскраске $C^{2}$, появились во время работы \hyperref[formula2]{Алгоритма 2}. В силу данного предположения, каждое такое одноцветное ребро имеет хотя бы одну вершину, которая поменяла свой цвет во время работы \hyperref[formula2]{Алгоритма 2}. 
	
	Нам удобно ввести следующее обозначение:
	Пусть $\sigma$ и $C^{0}$ заданы случайно. Обозначим через $X$ случайную величину равную числу одноцветных ребер в раскраске $C^{2}$.
	
	\begin{lemma}
		Пусть  $\tilde{p}=\frac{q}{m/r-q/2}$, где $q$ --- параметр из \hyperref[formula2]{Алгоритма 2}.
		Тогда,
		
		\begin{gather*}
		\text{\sf E} X<ck(1+\tilde{p}(r-1))^n.
		\end{gather*}
		
	\end{lemma}
	
	\begin{proof} 
		
		Как и прежде, зафиксируем некоторое $T(A,T(B_{1}),...,T(B_{s}))$ --- 
		
		$T$-сложное дерево с корнем $A$ и потомками первого порядка: $B_{1},...,B_{s}, s\in\{1,...,\log_{2}r\}$. Обозначим через $t_{i}$ число вершин в пересечении $A\cap T(B_{i})$, а через $m_{i}$ --- размер $T$-поддерева $T(B_{i})$. Пусть $\alpha$ цвет ребра $A$ в раскраске $C^{2}$. 
		
		Как и в случае $T$-деревьев, по структуре графа $T$ однозначно определяются цвета всех доминантных вершин в раскраске $C^{0}$. Заметим, что $T(B_{1}),...,T(B_{s})$ являются неперсекающимися $T$-поддеревья, и поэтому для вершин гиперграфа $H$, попадающих в эти $T$-поддеревья выполняются все соотношения из Леммы \ref{lemma5}.
		
		Рассмотрим теперь вершины ребра $A$: 
		
		\begin{enumerate}
			\item Если $u\in A\cap\left(\cup_{t} T(B_{t})\right)$, то изначальный цвет такой вершины уже известен.
			\item Если $w\in A\setminus\left(\cup_{t} T(B_{t})\right)$, то она либо цвета $\alpha$ , либо  она попала в одно из множеств $V_{i}, i=1,...,r$ и имеет в $C^{0}$ цвет $i$. 
		\end{enumerate}
		
		Для удобства введем обозначения для некоторых событий. Обозначим через $\mathcal{F}_A(n-t)$, событие, заключающееся в том, что вершины $w$ корня $A$, покрашены так, что $T(A,T(B_{1}),...,T(B_{s}))$ --- $T$-сложное дерево. Соответственно, через $\mathcal{F}_{B_{i}}(t_{i})$ --- событие, заключающееся в том, что вершины $u$ раскрашены соответствующим образом.
		Тогда,
		
		\begin{gather}
		\Prob(T(A,B_{1},...,B_{s}))\leq\left(\prod_{i=1}^{s}\Prob(T(B_{i}))\right)\left(\prod_{i=1}^{s}\Prob(\mathcal{F}_{B_{i}}(t_{i}))\right)\Prob(\mathcal{F}_A(n-t))
		\end{gather}
		
		Выпишем оценки для каждого множителя:
		
		\begin{gather}
		\Prob(T(B_{i}))\leq\left(\frac{1}{r}\right)^{(n-1)m_{i}+1}p^{m_{i}-1},
		\\
		\Prob(\mathcal{F}_{B_{i}}(t_{i}))\leq t_{i}\cdot p\cdot\tilde{p}^{(t_{i}-1)}=r^{-(t_{i}-1)}\cdot(r\tilde{p})^{(t_{i}-1)}\cdot t_{i}\cdot p,
		\\
		\Prob(\mathcal{F}_A(n-t))\leq r\left(\frac{1+\tilde{p}(r-1)}{r}\right)^{n-t}\leq r^{t+1-n}\left(1+\tilde{p}(r-1)\right)^{n}
		\end{gather}
		
		Оценки $(3)$ и $(4)$ получены из того факта, что если подмножество вершин $V_{i}$ размера $q$ выбирается случайно, то для любого набора  $\{v_{i_{1}},...,v_{i_{l}}\}$ совместная вероятность $\Prob(\{v_{i_{1}},...,v_{i_{l}}\}\in V_{i})\leq\prod_{t}\Prob(v_{i_{t}}\in V_{i}\leq\prod_{t}\left(\frac{q}{m/r-q/2}\right)$, где $m/r-q/2$ --- минимально возможный размер цветового класса $K_{i}$, из которого выбирается подмножество $V_{i}$(см.\ref{sh_i} ). Отсюда, в частности, следует, что
		
		\begin{gather*}
		\tilde{p}r=\frac{r\cdot q}{m/r-q/2}\leq\frac{r\cdot \left(\frac{n}{\ln(n)}\right)^{\lfloor \log_{2}(r)/\log_{2}(r)+1\rfloor}+2r\sqrt{\frac{2m\ln r/c}{r}}}{m/r-q/2}\rightarrow 0
		\end{gather*}
		
		при $n\rightarrow\infty$ и $r<\left(\frac{n}{\ln n}\right)^{\ln 2}$.
		
		Подставим в $(1)$ оценки $(2),(3)$ и $(4)$.
		
		\begin{gather*}
		\Prob(T(A,B_{1},...,B_{s}))\leq r\left(\frac{1}{r}\right)^{(n-1)m+1}\cdot p^{m-1}\cdot(1+\tilde{p}(r-1))^n\cdot\prod_{i=1}^{s} (r\tilde{p})^{(t_{i}-1)}\cdot t_{i}
		\end{gather*}
		
		Рассмотрим функцию $f(x)=(r\tilde{p})^{(x-1)}\cdot x$ на $[1;\infty)$. Ее можно переписать в виде $f(x)=\exp(-\beta(x-1))\cdot x$, где $\beta=\ln\left(\frac{1}{r\tilde{p}}\right)>1$. Функция $f(x)$ убывает на $[1;\infty)$, так как ее  производная $f'(x)=(1-\beta x)\exp(-\beta(x-1))$ равна нулю при $x=1/\beta<1$ и  отрицательна при $x>1/\beta$. Поэтому, наибольшее значение $f(x)$ на $[1;\infty)$ равно 1 при $x=1$.
		
		С учетом полученной оценки на $f(x)$:
		
		\begin{gather*}
		\Prob(T(A,B_{1},...,B_{s}))\leq p^{m-1}\cdot (1+\tilde{p}(r-1))^n\left(\frac{1}{r}\right)^{(n-1)m}
		\end{gather*}
		
		Суммируя по всем $m$ произведения $\Prob(T(A,B_{1},...,B_{s}))m\cdot\binom{|E|}{m} 2^{m-1}$,
		
		\begin{gather*}
		\text{\sf E} X\leq\sum_{m=1} p^{m-1}m\cdot\binom{|E|}{m}\cdot 2^{m-1}\cdot (1+\tilde{p}(r-1))^n\left(\frac{1}{r}\right)^{(n-1)m}\leq ck(1+\tilde{p}(r-1))^n.
		\end{gather*}
		
	\end{proof}
	
	\begin{corollary}
		Пусть раскраска $C^{0}$ и отображение $\sigma$ заданы случайно, тогда с положительной вероятностью одноцветных ребер в раскраске $C^{2}$ будет меньше, чем $q/2$.
	\end{corollary}
	
	\begin{proof}
		Согласно лемме 6, 
		\begin{align*}
		\text{\sf E} X\leq ck(1+\tilde{p}(r-1))^n,
		\end{align*}
		поэтому с положительной вероятностью $$X<\frac{k(1+\tilde{p}(r-1))^n}{2}$$
		Оценим $2X$:
		\begin{align*}
		2X\leq
		&k(1+\tilde{p}(r-1))^n\leq k\exp\{n\tilde{p}(r-1)\}=k\exp\left\{n(r-1)\frac{q}{m/r-q/2}\right\}\\
		&\mbox{(используя явные соотношения (1) на $q$ и $k$, а также оценку на $m$ из леммы 1)} \\
		&\leq k\exp\left\{n(r-1){\left(k+2\sqrt{2(\ln r/c)m/r}\right)\over m/r-q/2}\right\}\leq k\exp\left\{n(r-1){\left(4\sqrt{2(\ln r/c)m/r}\right)\over m/r-q/2}\right\}\leqslant\notag \\ 
		&\leq k\exp\left\{4(r-1)\sqrt{2(\ln n) 2\ln r/c} \right\}
		\leqslant k\exp\left\{(\ln n)\cdot 8r\sqrt{{\ln r/c\over \ln n}}\right\}\notag\\
		&\mbox{(предположим, что $\frac{ 8r\sqrt{\ln r/c}}{\sqrt{\ln n}}\leq\frac{1}{\log_{2}r+1}$  )}\notag\\
		&\leqslant k\cdot\exp\left\{{\ln n\over \log_{2}r+1}\right\}\leq k\cdot n^{\frac{1}{\log_{2}r+1}}=\frac{n}{(\ln n)^{\frac{\log_{2}r}{\log_{2}r+1}}}\leq q=\left(k+2\sqrt{\frac{2m(\ln r/c)}{r}}\right)\notag.
		\end{align*}
		Осталось показать, что действительно верно соотношение
		\begin{gather*}
		\frac{8r\sqrt{\ln r/c}}{\sqrt{\ln n}}\leq\frac{1}{\log_{2}r+1},
		\end{gather*}
		когда $r\leq\sqrt{\frac{\ln n}{\tilde{c}(\ln \ln n)^3}}$
		
		\begin{align*}
		\frac{8r(\log_{2}r+1)\sqrt{\ln r/c}}{\sqrt{\ln n}}&\leq\frac{8\cdot \sqrt{\frac{\ln n}{\tilde{c}(\ln \ln n)^3}}(\ln\ln n+1)\sqrt{\ln\ln n+\ln 1/c}}{\sqrt{\ln n}}\leq\notag\\
		&\mbox{(подставляя оценку на $r$)}\notag\\
		&\leq 8\cdot \sqrt{\frac{1}{\tilde{c}(\ln \ln n)^3}}(\ln\ln n+1)\sqrt{\ln\ln n\cdot\ln 1/c}<1\\
		&\mbox{(уже при  $\tilde{c}\geq 64\ln\frac{1}{c}$)}\notag\
		\end{align*}
	\end{proof}
	
	\section{Завершение доказательство \hyperref[mntheorem]{Теоремы 3}}
	
	Пусть $H=(V,E)$ $n$-однородный гиперграф $H$, в котором 
	
	$|E|\leq c\left(\frac{n}{\ln n}\right)^{\lfloor \log_{2}(r)/\log_{2}(r)+1\rfloor} r^{n-1}$, a число цветов $r\leq\sqrt{\frac{\ln n}{\tilde{c}(\ln \ln n)^3}}$. 
	
	Докажем, что $H$ можно справедливо раскрасить в $r$ цветов.
	Согласно лемме 1, мы можем считать что число вершин $m>\frac{n^2(r-1)}{2\ln n}$. Рассмотрим случайную раскраску $C^{0}$ и отображения $\sigma:V \to [0,1]$, где $\sigma(v),v\in V$ --- независимые случайные величины с равномерным распределением на $[0,1]$. Применим к гиперграфу $H$ \hyperref[formula]{Алгоритм 1 } для построение правильной раскраски. \hyperref[formula]{Алгоритм 1}, согласно Лемме 5 построит из $C^{0}$ некоторую правильную раскраску $C^{1}$ с вероятностью не меньше, чем $1-8c$. 
	
	После работы \hyperref[formula]{Алгоритма 1} мощности цветовых классов $K_{i}$ могут отличаться от $m/r$, но с вероятностью не меньше, чем $1-10c$ выполнено, что $q/2\leq |K_{i}|-m/r\leq q/2$. Выберем случайно в каждом цветовом классе $K_{i}$ подмножество вершин $V_{i}$ размера $q$ и применим \hyperref[formula2]{Алгоритм 2}. \hyperref[formula2]{Алгоритм 2} сделает все цветовые классы равными $m/r$. Если при этом, мы сможем выбирать из множеств $V_{i}$ вершины для перекраски таким образом, чтобы не появлялись новые одноцветные ребра, то мы получим справедливую раскраску.
	
	Следствие 3 утверждает, что с вероятностью не меньше, чем $1-2c$ число всех одноцветных ребер будет меньше, чем $q/2$. Тогда если мы не будем брать по одной вершине из каждого такого ребра, то в каждом $V_{i}$ останется еще хотя бы $q/2$ вершин. Этого числа достаточно, чтобы \hyperref[formula2]{Алгоритм 2} уровнял мощности цветовых классов.
	
	Выбор параметров: вероятность того, что у нас не получилось справедливой раскраски не превосходит $8c+10c+2c=20c<1$ уже при $c<0.05$.
	\hyperref[mntheorem]{Теорема 3} доказана.
	
	

   	
			
			
			
			
	
	
			
			\newpage
			
			\renewcommand{\refname}{Список литературы}
			\begin{thebibliography}{99}\label{bibliography}
				
				\bibitem{ErdLov} P. Erd\H{o}s, L. Lov\'asz, ``Problems and results on 3-chromatic hypergraphs and some related questions'', \textit{Infinite and Finite Sets}, Colloquia Mathematica Societatis Janos Bolyai, \textbf{10}, Amsterdam: North Holland, 1973, 609--627.
				
				
				\bibitem{RaigShab} A.M. Raigorodskii, D.A. Shabanov, ``The Erd\H{o}s--Hajnal problem, its generalizations and related problems'', \emph{Russian Mathematical Surveys}, \textbf{66}:5 (2011), 933--1002.
				
				\Bibitem{CherkKozik} 
\by D. Cherkashin, J. Kozik
\paper A note on random greedy coloring of uniform hypergraphs
\jour Random Structures and Algorithms
\vol 47
\issue 3
\yr 2015
\pages 407--413

				\bibitem{RadhSrin} J. Radhakrishnan, A. Srinivasan, ``Improved bounds and algorithms for hypergraph two-coloring'', \emph{Random Structures and Algorithms}, \textbf{16}:1 (2000), 4--32.
				
				
				
				\bibitem{AkolShab} I.A. Akolzin, D.A. Shabanov, ``Colorings of hypergraphs with large number of colors'', \emph{Discrete Mathematics}, \textbf{339}:12 (2016), 3020--3031.
				
				\bibitem{KK} A.V. Kostochka, M. Kubmhat, ``Coloring uniform hypergraphs with few edges'', \textit{Random Structures and Algorithms}, \textbf{35}:3 (2009), 348--368.
				\bibitem{Kozik} J. Kozik, ``Multipass greedy coloring of simple uniform hypergraphs'', \emph{Random Structures and Algorithms}, \textbf{48}:1 (2016), 125--146.
				
				\RBibitem{KupShab}
\by A.B. Kupavskii, D.A. Shabanov
\paper Colorings of uniform hypergraphs with large girth and applications
\jour Doklady Akademii Nauk
\yr 2012
\vol 443
\issue 4
\pages 422--426

\bibitem{Shab2} Д. А. Шабанов "Об обобщении теоремы Хайнала-Семереди для однородных гиперграфов"/ Доклады Академии Наук, т.459 №1 (2014), с. 22-26

\bibitem{KozikShab} J. Kozik, D.A. Shabanov, ``Improved algorithms for colorings of simple hypergraphs and applications'', \emph{Journal of Combinatorial Theory, Series B}, \textbf{116} (2016), 312--332.

\bibitem{KostRodl} A.V. Kostochka, V. R\"odl, ``Constructions od sparse uniform hypergraphs with high chromatic number'', \textit{Random Structures and Algorithms}, \textbf{36}:1 (2010), 46--56.

\bibitem{ErdHaj} P. Erd\H{o}s, A.Hajnal,  ``On a property of families of sets'', \emph{Acta Math. Acad.Sci. Hungar.},\textbf{1}:1-2 (1961), 87--123.

\bibitem{Erd} P. Erd\H{o}s, ``On a combinatorial problem. II”, \emph{Acta Math. Acad. Sci. Hungar.}, \textbf{15}:3-4 (1964), 445–447.
			
\bibitem{Erd2} P. Erd\H{o}s , ``Theory of Graphs and Its Applications” (M. Fieldler, Ed.) Czech. Acad. Sci. Publ., Prague, \textbf{9} (1964), 159.
		
		\bibitem{HajSem} A. Hajnal, E. Szemeredi, ``Proof of a conjecture of P. Erd\H{o}s'', \emph{Combinatorial theory and its applications}, North-Holland, London, \textbf{II} (1969), 601-–623
		
		\bibitem{KierKost} H. A. Kierstead, A. V. Kostochka, ``A short proof of the Hajnal-Szemeredi Theorem on equitable coloring'', \emph{Combinatorics, Probability and Computing}, \textbf{17} (2008), 265–270.
		
		\bibitem{KKMS} A. V. Kostochka, M. Mydlarz, E. Szemeredi, H.A. Kierstead, ``A fast algorithm for equitable coloring'', \emph{Combinatorica}, \textbf{30(2)} (2010), 217--224.
		
		
		
		\bibitem{Shab3} D.A. Shabanov, ``Random coloring method in the combinatorial problem of Erd\H{o}s and Lov\'asz'', \textit{Random Structures and Algorithms}, \textbf{40}:2 (2012), 227--253.
		
		\bibitem{Shab} D. A. Shabanov "Equitable two-colorings of uniform hypergraphs"/ European Journal of Combinatorics, т.43 (2015), с. 185-203
		
		\bibitem{Akol} И. А. Аколзин "О справедливых раскрасках простых гиперграфов"/ ТРУДЫ МФТИ, т.9, №4 (2017), с. 161--173

			 \bibitem{Kost} A. Kostochka, ``Coloring uniform hypegraphs with few colors'', \emph{Random Structures and Algorithms}, \textbf{24} (2010), 1--10.
			
				
				
				\bibitem{Beck} J. Beck, ``A remark concerning arithmetic progressions'', \emph{Journal of Combinatorial Theory, Series A}, \textbf{29} (1980), 376--379.
				
				\bibitem{KMRT} A.V. Kostochka, D. Mubayi, V. R\"odl, P. Tetali, ``On the chromatic number of set systems'', \emph{Random Structures and Algorithms}, \textbf{19}:2 (2001), 87--98.
				
		
			

			
			
			
			
			
			
			
			
			
			
			
			
            
		
		


		
	\end{thebibliography}
	
	
\end{document}

